(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-445058da"],{"0390":function(e,t,r){"use strict";var n=r("02f4")(!0);e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},"08d2":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-grade-page"},[r("section",{staticClass:"content-container"},[r("div",{staticClass:"basic-info"},[r("span",{staticClass:"label"},[e._v(e._s(e.constants.BASIC_INFO)+":")]),r("span",[r("span",{staticClass:"greycolor"},[e._v(e._s(e.constants.LEADER_NUMBER))]),e._v("\n        / "+e._s(e.basicInfo.superior_workcode)+"   \n        "),r("span",{staticClass:"greycolor"},[e._v(e._s(e.constants.LEADER_NAME))]),e._v("\n        / "+e._s(e.basicInfo.superior_name)+" ")]),e._v("    \n      "),r("span",{staticClass:"tip"},[e._v("注: 若上级姓名工号与实际不符, 请联系HR")])]),r("br"),e._l(e.cardData,function(t,n){return r("card",{key:n,staticClass:"card",attrs:{readOnly:e.readOnly,placeholder:"请描述该项目标的实际完成情况",desc:e.targets[n].desc,config:e.cardConfig,data:t,index:n},on:{"update:desc":function(t){return e.$set(e.targets[n],"desc",t)}},model:{value:e.targets[n].mark,callback:function(t){e.$set(e.targets[n],"mark",t)},expression:"targets[i].mark"}})}),r("br"),e.showComments&&e.superior_score&&e.superior_score.evaluation&&e.published?r("div",[r("comments",{attrs:{readOnly:!0,comments:e.superior_score&&e.superior_score.evaluation},on:{"update:comments":function(t){return e.$set(e.superior_score&&e.superior_score,"evaluation",t)}}}),r("br")],1):e._e(),e.showMyAdditional?r("div",[r("addition-mark",{attrs:{prefixTitle:e.constants.LABEL_SELF,readOnly:e.readOnly,desc:e.myAdditionMark.evaluation,mark:e.myAdditionMark.score},on:{"update:desc":function(t){return e.$set(e.myAdditionMark,"evaluation",t)},"update:mark":function(t){return e.$set(e.myAdditionMark,"score",t)}}}),r("br")],1):e._e(),e.leaderAdditionMark.evaluation&&e.published?r("div",[r("addition-mark",{attrs:{readOnly:!0,prefixTitle:e.constants.LABEL_SUP,desc:e.leaderAdditionMark.evaluation,mark:e.leaderAdditionMark.score},on:{"update:desc":function(t){return e.$set(e.leaderAdditionMark,"evaluation",t)},"update:mark":function(t){return e.$set(e.leaderAdditionMark,"score",t)}}}),r("br")],1):e._e(),e.showTotal&&e.canEdit?r("div",[r("total-mark",{attrs:{total:e.total}}),r("br")],1):e._e(),r("div",[e.level&&e.published?r("level",{attrs:{readOnly:!0},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}}):e._e(),r("br")],1),e.canEdit?r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-button",{staticClass:"btn-reset",attrs:{round:"",size:"medium"},on:{click:e.saveDraft}},[e._v(e._s(e.constants.SAVE_DRAFT))]),r("el-button",{attrs:{round:"",size:"medium",type:"primary"},on:{click:e.submit}},[e._v(e._s(e.constants.SUBMIT))])],1):e._e(),e.canReject&&e.published?r("el-row",{attrs:{type:"flex",justify:"center"}},[r("div",[e._v("\n        到期将默认确认结果, 如有问题可\n        "),r("el-button",{attrs:{type:"text"},on:{click:function(t){e.visible=!0}}},[e._v(e._s(e.constants.APPEAL))])],1)]):e._e(),e.cancelReject&&e.published?r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-button",{attrs:{type:"primary",round:"",size:"medium"},on:{click:e.cancel}},[e._v(e._s(e.constants.CANCEL_APPEAL))])],1):e._e(),r("reject-dialog",{attrs:{visible:e.visible},on:{close:e.getInfo,"update:visible":function(t){e.visible=t}}})],2)])},a=[],s=(r("a481"),r("cebc")),o=r("38fb"),i=r("fea5"),c=r("c9f1"),u={data:function(){return{basicInfo:{},readOnly:!1,canEdit:!1,canReject:!1,showTotal:!1,showComments:!1,cancelReject:!1,myAdditionMark:{},leaderAdditionMark:{},superior_score:{},need_attach_score:"",visible:!1,published:!1,level:"",targets:[],cardConfig:{min:0,max:5,step:.1},constants:{SUBMIT:o["Ud"],SAVE_DRAFT:o["Jd"],APPEAL:o["f"],CANCEL_APPEAL:o["v"],LABEL_SELF:o["sc"],LABEL_SUP:o["vc"],LEADER_NUMBER:o["Cc"],LEADER_NAME:o["Bc"],BASIC_INFO:o["l"]}}},components:{card:function(){return r.e("chunk-2fa14f13").then(r.bind(null,"4e80"))},"addition-mark":function(){return r.e("chunk-6b505a84").then(r.bind(null,"5923"))},"total-mark":function(){return r.e("chunk-11f6092e").then(r.bind(null,"5ea4"))},level:function(){return r.e("chunk-3bd107da").then(r.bind(null,"7bb4"))},"reject-dialog":function(){return r.e("chunk-9e59c0ec").then(r.bind(null,"4853"))},comments:function(){return r.e("chunk-2a31eacc").then(r.bind(null,"f160"))}},computed:{showMyAdditional:function(){return 1==this.need_attach_score&&(this.readOnly&&this.myAdditionMark.evaluation||!this.readOnly)},total:function(){return this.superior_score&&null!=this.superior_score.score?parseFloat(this.superior_score.score):parseFloat(this.targets.map(function(e){return e.weights*(e.mark||0)}).reduce(function(e,t){return e+t},0)+(parseFloat(this.myAdditionMark.score)||0)).toFixed(2)},cardData:function(){return this.published?this.targets:this.hideLeaderInfo(this.targets)}},methods:{hideLeaderInfo:function(e){return e.map(function(e){var t=Object(s["a"])({},e);return delete t.target_superior_score,t})},saveDraft:function(){var e=this,t=this.getPostData();return Object(i["Fb"])(this.$route.params.orgID,this.$route.params.id,t).then(function(t){e.$message({type:"success",message:"草稿保存成功"}),e.getDetailInfo()}).catch(function(e){})},getPostData:function(){return{score:this.targets.map(function(e){var t=e.id,r=e.mark,n=e.desc;return{target_id:t,score:r,description:n}}),attach_score:{score:this.myAdditionMark.score||0,reason:this.myAdditionMark.evaluation||""},total_score:this.total}},checkTotal:function(){return parseFloat(this.total)>5},getInfo:function(){var e=this;return Object(i["o"])(this.$route.params.orgID,this.$route.params.id,"self").then(function(t){var r=t.targets,n=t.superior_workcode,a=t.need_attach_score,s=t.stage,o=t.self_attach_score,i=t.superior_attach_score,c=t.superior_score,u=t.superior_name,l=t.score_level,d=t.score,f=t.publish_status;e.basicInfo={superior_workcode:n,superior_name:u};var h=1==f;e.published=h,e.need_attach_score=a,e.myAdditionMark=o||{},e.leaderAdditionMark=i||{},e.level=l||c&&c.score_level,e.superior_score=c,e.showComments=s>=40,e.composeData(r,s),60!=s||d||(e.showTotal=!1),h&&(e.readOnly=!0,e.canEdit=!1)}).catch(function(e){})},beforeSubmitCheck:function(){var e=this;return new Promise(function(t,r){return e.targets.some(function(e){return!e.desc})?(e.$notify.error({title:o["sb"],message:"请填写自评理由!"}),r(!0)):e.showMyAdditional&&e.myAdditionMark.score&&!e.myAdditionMark.evaluation?(e.$notify.error({title:o["sb"],message:"请填写加减分原因"}),r(!0)):e.checkTotal()?(e.$notify.error({title:o["sb"],message:"总分已经超过5分"}),r(!0)):t(!0)})},submit:function(){var e=this;return this.beforeSubmitCheck().then(function(){e.$confirm("自评分为".concat(e.total,"分，请确认无误再提交，一经提交无法修改, 是否继续?"),"提示",{confirmButtonText:o["z"],cancelButtonText:o["u"],type:"warning"}).then(function(){var t=e.getPostData();return delete t.total_score,Object(i["xb"])(e.$route.params.id,t).then(function(t){e.$message({type:"success",message:o["A"]}),e.$router.replace(c["j"])}).catch(function(e){})}).catch(function(){})}).catch(function(){})},composeData:function(e,t){switch(t){case 10:this.readOnly=!0,this.targets=e.map(function(e){return delete e.target_self_score,delete e.target_superior_score,e}),this.need_attach_score="",this.canEdit=!1,this.showTotal=!1;break;case 20:this.readOnly=!1,this.canEdit=!0,this.showTotal=!0,this.targets=e.map(function(e){return e.mark=e.target_self_score&&e.target_self_score.score||0,e.desc=e.target_self_score&&e.target_self_score.description||"",delete e.target_self_score,delete e.target_superior_score,e});break;case 30:this.readOnly=!0,this.canEdit=!1,this.showTotal=!0,this.targets=e.map(function(e){return e.mark=e.target_self_score&&e.target_self_score.score||0,e.desc=e.target_self_score&&e.target_self_score.description||"",e});break;case 40:this.readOnly=!0,this.canEdit=!1,this.showTotal=!0,this.targets=e.map(function(e){return e.mark=e.target_self_score&&e.target_self_score.score||0,e.desc=e.target_self_score&&e.target_self_score.description||"",e}),this.canReject=!0,this.cancelReject=!1;break;case 50:this.readOnly=!0,this.canEdit=!1,this.showTotal=!0,this.targets=e.map(function(e){return e.mark=e.target_self_score&&e.target_self_score.score||0,e.desc=e.target_self_score&&e.target_self_score.description||"",e}),this.canReject=!1,this.cancelReject=!0;break;default:this.readOnly=!0,this.canEdit=!1,this.showTotal=!0,this.targets=e.map(function(e){return e.mark=e.target_self_score&&e.target_self_score.score||0,e.desc=e.target_self_score&&e.target_self_score.description||"",e}),this.canReject=!1,this.cancelReject=!1}},cancel:function(){var e=this;return Object(i["d"])({performance_user_id:this.$route.params.id}).then(function(t){e.$message({type:"success",message:"取消成功!"}),e.getInfo()}).catch(function(e){})}},created:function(){this.getInfo()}},l=u,d=(r("2e46"),r("2877")),f=Object(d["a"])(l,n,a,!1,null,"a09723d2",null);t["default"]=f.exports},"214f":function(e,t,r){"use strict";r("b0c5");var n=r("2aba"),a=r("32e9"),s=r("79e5"),o=r("be13"),i=r("2b4c"),c=r("520a"),u=i("species"),l=!s(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();e.exports=function(e,t,r){var f=i(e),h=!s(function(){var t={};return t[f]=function(){return 7},7!=""[e](t)}),p=h?!s(function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[u]=function(){return r}),r[f](""),!t}):void 0;if(!h||!p||"replace"===e&&!l||"split"===e&&!d){var _=/./[f],v=r(o,f,""[e],function(e,t,r,n,a){return t.exec===c?h&&!a?{done:!0,value:_.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),g=v[0],m=v[1];n(String.prototype,e,g),a(RegExp.prototype,f,2==t?function(e,t){return m.call(e,this,t)}:function(e){return m.call(e,this)})}}},"2e46":function(e,t,r){"use strict";var n=r("f9f7"),a=r.n(n);a.a},"520a":function(e,t,r){"use strict";var n=r("0bfb"),a=RegExp.prototype.exec,s=String.prototype.replace,o=a,i="lastIndex",c=function(){var e=/a/,t=/b*/g;return a.call(e,"a"),a.call(t,"a"),0!==e[i]||0!==t[i]}(),u=void 0!==/()??/.exec("")[1],l=c||u;l&&(o=function(e){var t,r,o,l,d=this;return u&&(r=new RegExp("^"+d.source+"$(?!\\s)",n.call(d))),c&&(t=d[i]),o=a.call(d,e),c&&o&&(d[i]=d.global?o.index+o[0].length:t),u&&o&&o.length>1&&s.call(o[0],r,function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(o[l]=void 0)}),o}),e.exports=o},"5f1b":function(e,t,r){"use strict";var n=r("23c6"),a=RegExp.prototype.exec;e.exports=function(e,t){var r=e.exec;if("function"===typeof r){var s=r.call(e,t);if("object"!==typeof s)throw new TypeError("RegExp exec method returned something other than an Object or null");return s}if("RegExp"!==n(e))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(e,t)}},a481:function(e,t,r){"use strict";var n=r("cb7c"),a=r("4bf8"),s=r("9def"),o=r("4588"),i=r("0390"),c=r("5f1b"),u=Math.max,l=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};r("214f")("replace",2,function(e,t,r,_){return[function(n,a){var s=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,s,a):r.call(String(s),n,a)},function(e,t){var a=_(r,e,this,t);if(a.done)return a.value;var d=n(e),f=String(this),h="function"===typeof t;h||(t=String(t));var g=d.global;if(g){var m=d.unicode;d.lastIndex=0}var b=[];while(1){var k=c(d,f);if(null===k)break;if(b.push(k),!g)break;var y=String(k[0]);""===y&&(d.lastIndex=i(f,s(d.lastIndex),m))}for(var A="",x=0,E=0;E<b.length;E++){k=b[E];for(var w=String(k[0]),M=u(l(o(k.index),f.length),0),$=[],R=1;R<k.length;R++)$.push(p(k[R]));var O=k.groups;if(h){var j=[w].concat($,M,f);void 0!==O&&j.push(O);var C=String(t.apply(void 0,j))}else C=v(w,f,M,$,O,t);M>=x&&(A+=f.slice(x,M)+C,x=M+w.length)}return A+f.slice(x)}];function v(e,t,n,s,o,i){var c=n+e.length,u=s.length,l=h;return void 0!==o&&(o=a(o),l=f),r.call(i,l,function(r,a){var i;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(c);case"<":i=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return r;if(l>u){var f=d(l/10);return 0===f?r:f<=u?void 0===s[f-1]?a.charAt(1):s[f-1]+a.charAt(1):r}i=s[l-1]}return void 0===i?"":i})}})},b0c5:function(e,t,r){"use strict";var n=r("520a");r("5ca1")({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},f9f7:function(e,t,r){}}]);