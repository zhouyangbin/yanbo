(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1de44178"],{"4f9d":function(t,e,n){"use strict";var r=n("de65"),a=n.n(r);a.a},de65:function(t,e,n){},fbdf:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav-bar",{attrs:{list:t.nav}}),n("section",{staticClass:"content-container"},[n("el-row",{attrs:{align:"middle",type:"flex",justify:"space-between"}},[n("div",[n("span",[t._v("\n          "+t._s(t.constants.PERFORMANCE_GRADE_LIST)+"\n        ")]),n("el-cascader",{staticStyle:{"margin-left":"30px"},attrs:{placeholder:t.constants.LABEL_SELECT_DIVISION,props:t.filterProps,options:t.dpArr,"show-all-levels":!1},model:{value:t.filterForm.dp,callback:function(e){t.$set(t.filterForm,"dp",e)},expression:"filterForm.dp"}}),n("el-select",{staticStyle:{"margin-left":"30px"},attrs:{placeholder:"请选择周期类型"},model:{value:t.filterForm.type,callback:function(e){t.$set(t.filterForm,"type",e)},expression:"filterForm.type"}},t._l(t.constants.ENUM_PERFORMANCE_TYPE,function(t){return n("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),n("el-button",{staticStyle:{"margin-left":"30px"},attrs:{round:""},on:{click:t.resetFilter}},[t._v(t._s(t.constants.LABEL_EMPTY))])],1),t.canCreatePerformanceGrade?n("el-button",{attrs:{type:"primary",round:""},on:{click:t.createGrade}},[t._v(t._s(t.constants.CREATE_GRADE))]):t._e()],1),n("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,stripe:""}},[n("el-table-column",{attrs:{prop:"name",label:t.constants.GRADE_NAME,width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.name)+"\n          "),0===e.row.index?n("span",{staticClass:"newTag"},[t._v("\n            NEW!\n          ")]):t._e()]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"department",label:t.constants.DEPARTMENT,"min-width":"180"}}),n("el-table-column",{attrs:{prop:"type",label:t.constants.DURATION_TYPE}}),n("el-table-column",{attrs:{prop:"end_time",label:t.constants.FINISHED_DATE}}),n("el-table-column",{attrs:{prop:"start_time",label:t.constants.CREATED_DATE}}),n("el-table-column",{attrs:{prop:"address",label:t.constants.OPERATIONS},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.goSubList(e.row)}}},[t._v(t._s(t.constants.DETAILS))]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.gradeExport(e.row)}}},[t._v(t._s(t.constants.EXPORT_DETAILS))]),t.canCreatePerformanceGrade?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.copyGrade(e.row)}}},[t._v(t._s(t.constants.COPY_GRADE))]):t._e()]}}])})],1),n("br"),n("el-row",{attrs:{type:"flex",justify:"end"}},[n("pagination",{attrs:{currentPage:t.currentPage,total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1),t.createGradeDialog?n("grade-dialog",{attrs:{copyID:t.copyID,initData:t.initData,defaultChecked:t.checkedNodes,actionType:t.actionType,initForm:t.initForm,departmentTree:t.departmentTree,visible:t.createGradeDialog},on:{"update:visible":function(e){t.createGradeDialog=e}}}):t._e()],1)},a=[],i=n("38fb"),s=n("fea5"),o=n("c9f1"),l={data:function(){return{checkedNodes:[],departmentTree:[],actionType:"",copyID:"",filterProps:{value:"id",label:"name",children:"children"},filterForm:{type:"",dp:[]},createGradeDialog:!1,constants:{PERFORMANCE_GRADE_LIST:i["id"],CREATE_GRADE:i["G"],GRADE_NAME:i["Cb"],DETAILS:i["O"],EXPORT_DETAILS:i["rb"],ENUM_PERFORMANCE_TYPE:i["lb"],LABEL_SELECT_DIVISION:i["mc"],DEPARTMENT:i["L"],DURATION_TYPE:i["U"],FINISHED_DATE:i["yb"],CREATED_DATE:i["F"],OPERATIONS:i["fd"],COPY_GRADE:i["E"],LABEL_EMPTY:i["Wb"]},nav:[{label:i["Bb"],active:!0}],tableData:[],currentPage:1,total:0,initForm:{},initData:{},dpArr:[],permissions:[]}},components:{"nav-bar":function(){return n.e("chunk-5a85c387").then(n.bind(null,"3208"))},pagination:function(){return n.e("chunk-84bbef5e").then(n.bind(null,"486f"))},"grade-dialog":function(){return n.e("chunk-97886816").then(n.bind(null,"fada"))}},methods:{handleCurrentChange:function(t){this.currentPage=t,this.refreshList({page:t,department_id:this.selectedDep,type_id:this.filterForm.type})},refreshList:function(t){var e=this;return Object(s["I"])(t).then(function(t){var n=t.total,r=t.data;e.total=n,e.tableData=r.map(function(t,e){return t.index=e,t})})},createGrade:function(){var t=this;this.getOrgList(function(){t.createGradeDialog=!0})},copyGrade:function(t){this.actionType="copy",this.copyID=String(t.id);var e=t.template_id;this.initForm={tpl:e,mapping:t.rule_id,name:"",property:t.type_id.toString(),startTime:"",endTime:""};var n=[];for(var r in t.rules)n.push({id:parseInt(r),type:t.rules[r]});this.initData={tplArr:t.templates,rulesArr:n};var a=t.department.split(",");this.checkedNodes=t.department_ids.map(function(t,e){return{department_id:t,name:a[e]}}),this.createGrade()},gradeExport:function(t){window.open(Object(o["q"])(t.id),"_blank","noopener")},getOrgList:function(t){var e=this;return Object(s["G"])().then(function(n){e.departmentTree=n,t&&t()}).catch(function(t){})},getDepartments:function(){var t=this;return Object(s["G"])().then(function(e){t.dpArr=e}).catch(function(t){})},goSubList:function(t){this.$router.push(Object(o["P"])(t.id))},resetFilter:function(){this.filterForm={type:"",dp:[]}}},computed:{selectedDep:function(){return this.filterForm.dp.length>0?this.filterForm.dp[this.filterForm.dp.length-1]:""},canCreatePerformanceGrade:function(){return this.permissions.includes(301)}},watch:{filterForm:{handler:function(t){var e={page:1,department_id:t.dp.length>0?t.dp[t.dp.length-1]:"",type_id:t.type};this.currentPage=1,this.refreshList(e)},deep:!0,immediate:!0},createGradeDialog:function(t){t||(this.actionType="",this.copyID="",this.initForm={tpl:"",mapping:"",name:"",property:"",startTime:"",endTime:""},this.checkedNodes=[],this.refreshList({page:this.currentPage,department_id:this.selectedDep,type_id:this.filterForm.type}))}},created:function(){this.getDepartments(),this.permissions=JSON.parse(localStorage.getItem("permissions")||"[]")}},c=l,p=(n("4f9d"),n("2877")),d=Object(p["a"])(c,r,a,!1,null,"6903a027",null);d.options.__file="index.vue";e["default"]=d.exports}}]);