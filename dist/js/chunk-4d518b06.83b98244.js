(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d518b06"],{"641e":function(e,t,s){"use strict";var a=s("ceec"),n=s.n(a);n.a},9425:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"member-grade-details"},[s("nav-bar",{attrs:{list:e.nav}}),s("br"),s("section",{staticClass:"content-container",staticStyle:{padding:"40px"}},[s("basic-info",{attrs:{data:e.basicInfo}}),s("br"),s("hr"),s("br"),s("rule-text",{attrs:{text:e.constants.MY_MEMBER_RULE}}),s("br"),s("br"),s("case-area",{attrs:{readOnly:e.readOnly},model:{value:e.advantage,callback:function(t){e.advantage=t},expression:"advantage"}}),s("br"),s("case-area",{attrs:{readOnly:e.readOnly},model:{value:e.promotion,callback:function(t){e.promotion=t},expression:"promotion"}}),s("br"),s("section",{staticClass:"mark"},[s("el-row",{attrs:{align:"middle",type:"flex"}},[s("el-col",{staticStyle:{padding:"20px","border-right":"1px solid #979797"}},[s("div",{staticClass:"mark-label"},[e._v("\n            自评分数\n          ")]),s("grade-items",{attrs:{items:e.scores},model:{value:e.selectGradeItem,callback:function(t){e.selectGradeItem=t},expression:"selectGradeItem"}})],1),s("el-col",{staticStyle:{"padding-left":"50px"}},e._l(e.reasons,function(t,a){return s("div",{key:a,staticClass:"mark-reason"},[s("div",[e._v("\n              "+e._s(a+3)+"分理由:\n            ")]),s("div",[e._v("\n              "+e._s(t)+"\n            ")])])}))],1)],1),s("br"),s("div",{staticClass:"mark-flag-container"},[s("div",{staticClass:"mark-section"},[s("div",{staticClass:"mark-label"},[e._v("\n          为"+e._s(e.employee_name)+"的成就客户项目评分\n        ")]),s("br"),s("grade-slider",{attrs:{readOnly:e.readOnly},model:{value:e.scores[e.selectGradeItem].superior_score,callback:function(t){e.$set(e.scores[e.selectGradeItem],"superior_score",t)},expression:"scores[selectGradeItem].superior_score"}})],1),s("div",{staticStyle:{width:"20px"}}),s("div",{staticClass:"flag-section"},[s("div",{staticClass:"mark-label"},[e._v("\n          为"+e._s(e.employee_name)+"设计等级标签\n        ")]),s("br"),s("level-selector",{attrs:{disabled:e.readOnly},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}})],1)]),s("br"),e.scores[e.selectGradeItem].superior_score!=e.scores[e.selectGradeItem].score?s("case-area",{attrs:{readOnly:e.readOnly},model:{value:e.scores[e.selectGradeItem].superior_case,callback:function(t){e.$set(e.scores[e.selectGradeItem],"superior_case",t)},expression:"scores[selectGradeItem].superior_case"}}):e._e(),s("br"),e.readOnly?e._e():s("el-row",{attrs:{type:"flex",justify:"end"}},[e.submited?e._e():s("el-button",{attrs:{type:"primary"},on:{click:e.saveDraft}},[e._v("保存草稿")]),s("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},n=[],r=s("38fb"),c=s("c9f1"),i=s("fea5"),o={data:function(){return{employee_name:"",basicInfo:{},nav:[{label:r["xc"],href:c["F"]},{label:r["Hc"],href:Object(c["E"])(this.$route.params.id)},{label:"下级详情",active:!0}],level:"",advantage:"",promotion:"",selectGradeItem:0,submited:!1,readOnly:!1,scores:[{cases:[]}],constants:{MY_MEMBER_RULE:r["Ic"]}}},components:{"nav-bar":function(){return s.e("chunk-5a85c387").then(s.bind(null,"3208"))},"basic-info":function(){return s.e("chunk-8e8d666a").then(s.bind(null,"eb39"))},"rule-text":function(){return s.e("chunk-f91b1ecc").then(s.bind(null,"6c37"))},"case-area":function(){return s.e("chunk-463f71be").then(s.bind(null,"b5ec"))},"grade-items":function(){return s.e("chunk-66fcb243").then(s.bind(null,"da3f"))},"grade-slider":function(){return s.e("chunk-3af41547").then(s.bind(null,"aa29"))},"level-selector":function(){return s.e("chunk-3fe11798").then(s.bind(null,"7f4e"))}},methods:{getMemberDetail:function(){var e=this;Object(i["D"])(this.$route.params.uid).then(function(t){var s=t.advantage,a=t.promotion,n=t.scores,c=t.employee_name,i=t.employee_workcode,o=t.end_time,l=t._271_level,u=t.status;e.advantage=s,e.promotion=a,e.employee_name=c,e.readOnly=0==t.can_submit,e._271_is_necessary=!!t._271_is_necessary,e.basicInfo={name:c,workcode:i,finishedTime:"上级评截止时间: ".concat(o)},e.level=r["wc"][l].toLowerCase();var d=20==u;e.submited=d;var m="culture_member_draft_".concat(e.$route.params.uid),f=window.localStorage.getItem(m);if(d||!f)e.scores=n.map(function(e){return e.score=e.self_score,delete e.self_score,e});else{var p=JSON.parse(f);e.initFromLocal(p)}})},initFromLocal:function(e){this.scores=e.scores,this.level=e.level,this.advantage=e.advantage,this.promotion=e.promotion},composePostData:function(){var e={};return this.scores.forEach(function(t){e[t.question_id]={score:t.superior_score,cases:[t.superior_case]}}),e.promotion=this.promotion,e.advantage=this.advantage,e._271_level=r["vc"][this.level],e},validateData:function(){if(this.advantage&&this.promotion){if(this.level||!this._271_is_necessary)return this.checkReason();this.$message({message:"请选择等级!",type:"warning"})}else this.$message({message:"请填写优点和待提升部分",type:"warning"})},checkReason:function(){return!this.scores.some(function(e){return e.score!=e.superior_score&&!e.superior_case})},saveDraft:function(){var e="culture_member_draft_".concat(this.$route.params.uid);window.localStorage.setItem(e,JSON.stringify({scores:this.scores,level:this.level,advantage:this.advantage,promotion:this.promotion})),this.$message({message:"保存草稿成功!",type:"success"})},submit:function(){var e=this,t=this.validateData();t?this.$confirm("是否确定提交, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i["gb"])(e.$route.params.uid,e.composePostData()).then(function(t){e.$message({message:"提交成功",type:"success"}),e.getMemberDetail()}).catch(function(e){})}).catch(function(){}):this.$message({message:"请填写完整理由!",type:"warning"})}},created:function(){this.getMemberDetail()},computed:{reasons:function(){return this.scores[this.selectGradeItem].self_cases}}},l=o,u=(s("641e"),s("2877")),d=Object(u["a"])(l,a,n,!1,null,"1e69894b",null);d.options.__file="index.vue";t["default"]=d.exports},ceec:function(e,t,s){}}]);