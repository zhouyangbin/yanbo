{"version":3,"sources":["webpack:///src/components/modules/grademanage/progress/org/import/Dialog.vue","webpack:///./src/components/modules/grademanage/progress/org/import/Dialog.vue?37a3","webpack:///./src/components/modules/grademanage/progress/org/import/Dialog.vue"],"names":["Dialog","Boolean","IMPORT_TIPS","TEXT","IMPORT_RECORDS","EHR_IMPORT","WORK_LEVEL","ENUM_LEVELS","EXCEL_IMPORT","DRAG_FILE","CLICK_TO_UPLOAD","DOWNLOAD_EXCEL_TEMPLATE","CONFIRM","CANCEL","PATH_IMPORT_BY_EXCEL","URL","PATH_EXCEL_TPL","filter","v","value","_this","this","orgID","levels","postData","then","res","close","catch","e","message","data","initImportLevels","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","width","visible","dialogImport","on","slot","_v","_s","constants","model","callback","$$v","importTab","expression","label","name","ref","label-width","rules","importRules","importForm","prop","$set","_l","key","on-success","uploadSuccess","on-error","uploadErr","headers","uploadHeader","uploadData","drag","action","staticStyle","cursor","click","downloadTpl","max-height","tableData","scopedSlots","_u","fn","scope","row","reason","join","_e","type","justify","round","size","$event","importFiles","staticRenderFns","injectStyle","context","__webpack_require__","__vue_template_functional__","__vue_styles__","__vue_scopeId__","__vue_module_identifier__","Component","Object","component_normalizer","__webpack_exports__"],"mappings":"wJA2EAA,6BAIAC,iBAGA,qCAGA,0DAOA,kBACA,UACA,oBAIA,uBAEAC,YAAAC,EAAA,MACAC,eAAAD,EAAA,MACAE,WAAAF,EAAA,KACAG,WAAAH,EAAA,OACAI,YAAAJ,EAAA,KACAK,aAAAL,EAAA,KACAM,UAAAN,EAAA,KACAO,gBAAAP,EAAA,KACAQ,wBAAAR,EAAA,KACAS,QAAAT,EAAA,KACAU,OAAAV,EAAA,KACAW,qBAAAC,EAAA,KAEAC,eAAAD,EAAA,8BAGA,uEAIAE,OAAA,SAAAC,8BACA,6BACAC,iCAGA,IAAAC,EAAAC,qDAsBA,uCAhBAC,8BAGAC,uBAEAC,GAAAC,KAAA,SAAAC,uBAGAvB,EAAA,WAEA,cACAwB,UACAC,MAAA,SAAAC,qCASA,uDAIAC,0BACAC,qBACA,4BAEA5B,EAAA,8DAEA2B,8DAIA3B,EAAA,eACAA,EAAA,YAEA,iBACAwB,sCAGAZ,EAAA,mBACA,oFAOAO,2FAKA,wCAIAU,qBC9LAC,EAAA,WAA0B,IAAAC,EAAAb,KAAac,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,aAAuBE,YAAA,eAAAC,OAAkCC,MAAA,QAAAC,QAAAR,EAAAS,cAA2CC,IAAKjB,MAAAO,EAAAP,SAAmBU,EAAA,OAAYE,YAAA,QAAAC,OAA2BK,KAAA,SAAeA,KAAA,UAAcX,EAAAY,GAAA,SAAAZ,EAAAa,GAAAb,EAAAc,UAAA5C,gBAAA,UAAAiC,EAAA,OAA2EE,YAAA,cAAwBF,EAAA,WAAgBY,OAAO9B,MAAAe,EAAA,UAAAgB,SAAA,SAAAC,GAA+CjB,EAAAkB,UAAAD,GAAkBE,WAAA,eAAyBhB,EAAA,eAAoBG,OAAOc,MAAApB,EAAAc,UAAA3C,WAAAkD,KAAA,WAAiDlB,EAAA,WAAgBmB,IAAA,aAAAjB,YAAA,aAAAC,OAAiDiB,cAAA,OAAAC,MAAAxB,EAAAyB,YAAAV,MAAAf,EAAA0B,cAAqEvB,EAAA,gBAAqBG,OAAOc,MAAApB,EAAAc,UAAA1C,WAAAuD,KAAA,YAAkDxB,EAAA,qBAA0BY,OAAO9B,MAAAe,EAAA0B,WAAA,OAAAV,SAAA,SAAAC,GAAuDjB,EAAA4B,KAAA5B,EAAA0B,WAAA,SAAAT,IAAwCE,WAAA,sBAAiCnB,EAAA6B,GAAA7B,EAAAc,UAAA,qBAAA9B,GAAgD,OAAAmB,EAAA,eAAyB2B,IAAA9C,EAAA8C,IAAAxB,OAAiBc,MAAApC,EAAAC,MAAAoC,KAAA,gBAAmC,WAAAlB,EAAA,eAAiCG,OAAOc,MAAApB,EAAAc,UAAAxC,aAAA+C,KAAA,YAAoDlB,EAAA,aAAkBE,YAAA,WAAAC,OAA8ByB,aAAA/B,EAAAgC,cAAAC,WAAAjC,EAAAkC,UAAAC,QAAAnC,EAAAoC,aAAAvC,KAAAG,EAAAqC,WAAAC,KAAA,GAAAC,OAAAvC,EAAAc,UAAAlC,wBAAgKuB,EAAA,KAAUE,YAAA,mBAA6BF,EAAA,OAAYE,YAAA,oBAA8BL,EAAAY,GAAAZ,EAAAa,GAAAb,EAAAc,UAAAvC,WAAA,kBAAA4B,EAAA,MAAAH,EAAAY,GAAAZ,EAAAa,GAAAb,EAAAc,UAAAtC,sBAAA2B,EAAA,OAAgIE,YAAA,iBAAAC,OAAoCK,KAAA,OAAaA,KAAA,QAAYR,EAAA,KAAUqC,aAAaC,OAAA,WAAmB/B,IAAKgC,MAAA1C,EAAA2C,eAAyB3C,EAAAY,GAAAZ,EAAAa,GAAAb,EAAAc,UAAArC,gCAAAuB,EAAA,UAAAG,EAAA,YAA6FE,YAAA,YAAAmC,aAAqCjC,MAAA,QAAeD,OAAQsC,aAAA,MAAA/C,KAAAG,EAAA6C,aAAyC1C,EAAA,mBAAwBG,OAAOqB,KAAA,WAAAP,MAAA,QAAgCjB,EAAA,mBAAwBG,OAAOqB,KAAA,OAAAP,MAAA,QAA4BjB,EAAA,mBAAwBG,OAAOqB,KAAA,SAAAP,MAAA,MAA6B0B,YAAA9C,EAAA+C,KAAsBjB,IAAA,UAAAkB,GAAA,SAAAC,GAAiC,OAAAjD,EAAAY,GAAA,mBAAAZ,EAAAa,GAAAoC,EAAAC,IAAAC,OAAAC,KAAA,gCAA4F,GAAApD,EAAAqD,MAAA,OAAAlD,EAAA,QAAkCE,YAAA,SAAmBL,EAAAY,GAAA,WAAAZ,EAAAa,GAAAb,EAAAc,UAAA9C,aAAA,0BAAAgC,EAAAkB,UAAAf,EAAA,OAA0GE,YAAA,gBAAAC,OAAmCK,KAAA,UAAgBA,KAAA,WAAeR,EAAA,UAAeG,OAAOgD,KAAA,OAAAC,QAAA,YAAkCpD,EAAA,aAAkBG,OAAOkD,MAAA,GAAAC,KAAA,SAAAH,KAAA,WAA4C5C,IAAKgC,MAAA,SAAAgB,GAAyB1D,EAAA2D,YAAA,kBAAgC3D,EAAAY,GAAAZ,EAAAa,GAAAb,EAAAc,UAAApC,YAAAyB,EAAA,aAA0DE,YAAA,YAAAC,OAA+BkD,MAAA,GAAAC,KAAA,UAA2B/C,IAAKgC,MAAA1C,EAAAP,SAAmBO,EAAAY,GAAAZ,EAAAa,GAAAb,EAAAc,UAAAnC,YAAA,OAAAqB,EAAAqD,QAChuFO,iBCDA,SAAAC,EAAAC,GACAC,EAAA,QAQA,IAAAC,GAAA,EAEAC,EAAAJ,EAEAK,EAAA,kBAEAC,EAAA,KAEAC,EAAAC,OAAAC,EAAA,KAAAD,CACAvG,EACAiC,EACA6D,EACAI,EACAC,EACAC,EACAC,GAGAI,EAAA,WAAAH,EAAA","file":"js/23.41497ea7.js","sourcesContent":["<template>\n  <el-dialog @close=\"close\" width=\"500px\" :visible=\"dialogImport\" class=\"dialogImport\">\n    <div slot=\"title\" class=\"title\">\n      {{constants.IMPORT_RECORDS}}\n    </div>\n    <div class=\"importTab\">\n      <el-tabs v-model=\"importTab\">\n        <el-tab-pane :label=\"constants.EHR_IMPORT\" name=\"first\">\n          <el-form label-width=\"80px\" :rules=\"importRules\" ref=\"importForm\" :model=\"importForm\" class=\"importForm\">\n            <el-form-item :label=\"constants.WORK_LEVEL\" prop=\"levels\">\n              <el-checkbox-group v-model=\"importForm.levels\">\n                <el-checkbox v-for=\"v of constants.ENUM_LEVELS\" :key=\"v.key\" :label=\"v.value\" name=\"levels\"></el-checkbox>\n              </el-checkbox-group>\n            </el-form-item>\n          </el-form>\n        </el-tab-pane>\n        <el-tab-pane :label=\"constants.EXCEL_IMPORT\" name=\"second\">\n          <el-upload :on-success=\"uploadSuccess\" :on-error=\"uploadErr\" class=\"uploader\" :headers=\"uploadHeader\" :data=\"uploadData\" drag :action=\"constants.PATH_IMPORT_BY_EXCEL\">\n            <i class=\"el-icon-upload\"></i>\n            <div class=\"el-upload__text\">{{constants.DRAG_FILE}}\n              <em>{{constants.CLICK_TO_UPLOAD}}</em>\n            </div>\n            <div class=\"el-upload__tip\" slot=\"tip\">\n              <a style=\"cursor: pointer;\" @click=\"downloadTpl\">{{constants.DOWNLOAD_EXCEL_TEMPLATE}}</a>\n            </div>\n          </el-upload>\n          <el-table v-if=\"showTable\" class=\"err-table\" max-height=\"250\" :data=\"tableData\" style=\"width: 100%\">\n            <el-table-column prop=\"workcode\" label=\"工号\">\n            </el-table-column>\n            <el-table-column prop=\"name\" label=\"姓名\">\n            </el-table-column>\n            <el-table-column prop=\"reason\" label=\"原因\">\n              <template class=\"reason\" slot-scope=\"scope\">\n                {{scope.row.reason.join(\" \")}}\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-tab-pane>\n      </el-tabs>\n      <span class=\"tips\">\n        {{constants.IMPORT_TIPS}}\n      </span>\n    </div>\n\n    <div v-if=\"importTab==='first'\" slot=\"footer\" class=\"dialog-footer\">\n      <el-row type=\"flex\" justify=\"center\">\n        <el-button round size=\"medium\" type=\"primary\" @click=\"importFiles('importForm')\">{{constants.CONFIRM}}</el-button>\n        <el-button round size=\"medium\" @click=\"close\" class=\"btn-reset\">{{constants.CANCEL}}</el-button>\n      </el-row>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport {\n  IMPORT_TIPS,\n  IMPORT_RECORDS,\n  EHR_IMPORT,\n  WORK_LEVEL,\n  ENUM_LEVELS,\n  EXCEL_IMPORT,\n  DRAG_FILE,\n  CLICK_TO_UPLOAD,\n  DOWNLOAD_EXCEL_TEMPLATE,\n  CONFIRM,\n  CANCEL,\n  IMPORT_SUCCESS,\n  SUCCESS,\n  ERROR,\n  UPLOAD_SUCCESS,\n  UPLOAD_FAIL\n} from \"@/constants/TEXT\";\nimport { postEHR } from \"@/constants/API\";\nimport { PATH_IMPORT_BY_EXCEL, PATH_EXCEL_TPL } from \"@/constants/URL\";\n\nexport default {\n  props: {\n    dialogImport: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      importTab: \"first\",\n      importForm: {\n        levels: []\n      },\n      importRules: {\n        levels: [\n          {\n            type: \"array\",\n            required: true,\n            message: \"请至少选择一个级别\",\n            trigger: \"change\"\n          }\n        ]\n      },\n      constants: {\n        IMPORT_TIPS,\n        IMPORT_RECORDS,\n        EHR_IMPORT,\n        WORK_LEVEL,\n        ENUM_LEVELS,\n        EXCEL_IMPORT,\n        DRAG_FILE,\n        CLICK_TO_UPLOAD,\n        DOWNLOAD_EXCEL_TEMPLATE,\n        CONFIRM,\n        CANCEL,\n        PATH_IMPORT_BY_EXCEL,\n        PATH_EXCEL_TPL\n      },\n      tableData: [],\n      showTable: false\n    };\n  },\n  methods: {\n    initImportLevels() {\n      this.importForm.levels = ENUM_LEVELS.filter(\n        v => parseFloat(v.value) > 3.0\n      ).map(v => v.value);\n    },\n    // 导入操作提交\n    importFiles(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          // alert(\"submit!\")\n          // console.log(this.$route.params.orgID)\n          const postData = {\n            evaluation_id: this.$route.params.orgID,\n            // department_id: this.$route.params.orgID,\n            \"levels[]\": this.importForm.levels\n          };\n          // console.log(postData)\n          postEHR(postData)\n            .then(res => {\n              this.$message({\n                message: IMPORT_SUCCESS,\n                type: \"success\"\n              });\n              this.close();\n            })\n            .catch(e => {});\n        } else {\n          // console.log(\"error submit!!\")\n          return false;\n        }\n      });\n    },\n    close() {\n      this.$emit(\"close\");\n    },\n    uploadErr(err, file, fileList) {\n      // console.log(err, file, fileList)\n      const errObj = JSON.parse(err.message);\n      this.tableData = errObj.data;\n      this.showTable = true;\n      this.$notify.error({\n        title: ERROR,\n        message: `${file.name}${UPLOAD_FAIL}: ${errObj.message}`\n      });\n    },\n    uploadSuccess(response, file, fileList) {\n      this.$notify({\n        title: SUCCESS,\n        message: UPLOAD_SUCCESS,\n        type: \"success\"\n      });\n      this.close();\n    },\n    downloadTpl() {\n      const url = PATH_EXCEL_TPL;\n      window.open(url, \"_blank\");\n    }\n  },\n  computed: {\n    uploadData() {\n      return {\n        evaluation_id: this.$route.params.orgID\n      };\n    },\n    uploadHeader() {\n      return {\n        Authorization: `Bearer ${localStorage.getItem(\"talToken\")}`\n      };\n    }\n  },\n  created() {\n    this.initImportLevels();\n  }\n};\n</script>\n<style scoped>\n.importForm >>> .el-checkbox {\n  margin-left: 30px;\n}\n.dialogImport .title {\n  text-align: center;\n  font-weight: 700;\n  font-size: 18px;\n}\n.dialogImport >>> .el-dialog {\n  padding: 20px 40px;\n}\n.importTab {\n  position: relative;\n}\n.importTab .tips {\n  position: absolute;\n  right: 0;\n  top: 5px;\n  font-size: 12px;\n  color: grey;\n}\n.el-upload__tip >>> a {\n  color: #1e90ff;\n  text-decoration: none;\n}\n.el-upload__tip {\n  text-align: center;\n  font-size: 14px;\n}\n.uploader {\n  margin-top: 10px;\n}\n.err-table >>> .cell {\n  font-size: 12px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/modules/grademanage/progress/org/import/Dialog.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{staticClass:\"dialogImport\",attrs:{\"width\":\"500px\",\"visible\":_vm.dialogImport},on:{\"close\":_vm.close}},[_c('div',{staticClass:\"title\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"\\n    \"+_vm._s(_vm.constants.IMPORT_RECORDS)+\"\\n  \")]),_c('div',{staticClass:\"importTab\"},[_c('el-tabs',{model:{value:(_vm.importTab),callback:function ($$v) {_vm.importTab=$$v},expression:\"importTab\"}},[_c('el-tab-pane',{attrs:{\"label\":_vm.constants.EHR_IMPORT,\"name\":\"first\"}},[_c('el-form',{ref:\"importForm\",staticClass:\"importForm\",attrs:{\"label-width\":\"80px\",\"rules\":_vm.importRules,\"model\":_vm.importForm}},[_c('el-form-item',{attrs:{\"label\":_vm.constants.WORK_LEVEL,\"prop\":\"levels\"}},[_c('el-checkbox-group',{model:{value:(_vm.importForm.levels),callback:function ($$v) {_vm.$set(_vm.importForm, \"levels\", $$v)},expression:\"importForm.levels\"}},_vm._l((_vm.constants.ENUM_LEVELS),function(v){return _c('el-checkbox',{key:v.key,attrs:{\"label\":v.value,\"name\":\"levels\"}})}))],1)],1)],1),_c('el-tab-pane',{attrs:{\"label\":_vm.constants.EXCEL_IMPORT,\"name\":\"second\"}},[_c('el-upload',{staticClass:\"uploader\",attrs:{\"on-success\":_vm.uploadSuccess,\"on-error\":_vm.uploadErr,\"headers\":_vm.uploadHeader,\"data\":_vm.uploadData,\"drag\":\"\",\"action\":_vm.constants.PATH_IMPORT_BY_EXCEL}},[_c('i',{staticClass:\"el-icon-upload\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(_vm._s(_vm.constants.DRAG_FILE)+\"\\n            \"),_c('em',[_vm._v(_vm._s(_vm.constants.CLICK_TO_UPLOAD))])]),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_c('a',{staticStyle:{\"cursor\":\"pointer\"},on:{\"click\":_vm.downloadTpl}},[_vm._v(_vm._s(_vm.constants.DOWNLOAD_EXCEL_TEMPLATE))])])]),(_vm.showTable)?_c('el-table',{staticClass:\"err-table\",staticStyle:{\"width\":\"100%\"},attrs:{\"max-height\":\"250\",\"data\":_vm.tableData}},[_c('el-table-column',{attrs:{\"prop\":\"workcode\",\"label\":\"工号\"}}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"姓名\"}}),_c('el-table-column',{attrs:{\"prop\":\"reason\",\"label\":\"原因\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n              \"+_vm._s(scope.row.reason.join(\" \"))+\"\\n            \")]}}])})],1):_vm._e()],1)],1),_c('span',{staticClass:\"tips\"},[_vm._v(\"\\n      \"+_vm._s(_vm.constants.IMPORT_TIPS)+\"\\n    \")])],1),(_vm.importTab==='first')?_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"center\"}},[_c('el-button',{attrs:{\"round\":\"\",\"size\":\"medium\",\"type\":\"primary\"},on:{\"click\":function($event){_vm.importFiles('importForm')}}},[_vm._v(_vm._s(_vm.constants.CONFIRM))]),_c('el-button',{staticClass:\"btn-reset\",attrs:{\"round\":\"\",\"size\":\"medium\"},on:{\"click\":_vm.close}},[_vm._v(_vm._s(_vm.constants.CANCEL))])],1)],1):_vm._e()])}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-62db55ca\",\"hasScoped\":true,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/modules/grademanage/progress/org/import/Dialog.vue\n// module id = null\n// module chunks = ","function injectStyle (context) {\n  require(\"!!../../../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":false,\\\"minimize\\\":true}!../../../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-62db55ca\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Dialog.vue\")\n}\n/* script */\nexport * from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/Users/vincent/Documents/WorkDirectory/FE-PC-TDC/node_modules/.cache/cache-loader\\\"}!babel-loader!../../../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Dialog.vue\"\nimport __vue_script__ from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/Users/vincent/Documents/WorkDirectory/FE-PC-TDC/node_modules/.cache/cache-loader\\\"}!babel-loader!../../../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Dialog.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-62db55ca\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Dialog.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-62db55ca\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../../../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/modules/grademanage/progress/org/import/Dialog.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}