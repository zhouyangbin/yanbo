webpackJsonp([8],{"P+Uu":function(t,e){},Q8KN:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("n12u"),n("EuXz");var a=n("Biqn"),i=n.n(a),o=n("OE2U"),s=n("BHhq"),r={components:{"nav-bar":function(){return n.e(13).then(n.bind(null,"PI/7"))},"user-dialog":function(){return n.e(20).then(n.bind(null,"43ll"))},pagination:function(){return n.e(14).then(n.bind(null,"734F"))}},data:function(){return{nav:[{label:o["_92"],active:!0}],constants:{LABEL_NAME:o["_26"],LABEL_SCOPE:o["_34"],LABEL_STATUS:o["_40"],LABEL_CREATED_DATE:o["_11"],LABEL_OPERATIONS:o["_27"],LABEL_MODIFY:o["_25"],LABEL_FORBIDDEN:o["_16"],LABEL_ENABLED:o["_15"],LABEL_DEL:o["_12"],LABEL_ADD:o["_7"],LABEL_ADD_USER:o["_8"],LABEL_EMPTY:o["_14"],LABEL_SELECT_DIVISION:o["_36"]},conditionForm:{name:"",department_id:"",page:1},total:0,departments:[],adminsDepartments:[],department:[],addDialogVisible:!1,updateDialogVisible:!1,userForm:{email:"",name:"",department_id:"",empID:""},userId:"",tableColumn:[{prop:"name",label:o["_26"],width:"150"},{prop:"email",label:o["_43"],width:""}],userTable:[],tableLoading:!0,tableHeight:"calc(100% - 61px - 40px)"}},created:function(){this.getManagers(),this.getDepartments(),this.getAdminsDepartments()},methods:{getManagers:function(){var t=this,e=i()({},this.conditionForm);0==e.name.length&&delete e.name,0==e.department_id.length&&delete e.department_id,Object(s["l"])(e).then(function(e){t.tableLoading=!1,e&&(t.total=e.total,t.userTable=e.data)}).catch(function(e){t.tableLoading=!1})},getDepartments:function(){var t=this;Object(s["g"])().then(function(e){e.map(function(t){t.label=t.name,t.value=t.department_id}),t.departments=e}).catch(function(t){})},getAdminsDepartments:function(){var t=this;Object(s["e"])().then(function(e){var n=function t(e){e.map(function(e){e.label=e.name,e.value=e.department_id,e.children&&t(e.children)})};n(e),t.adminsDepartments=e}).catch(function(t){})},changeCondition:function(){this.conditionForm=Object.assign({},this.conditionForm,{page:0}),this.getManagers()},resetForm:function(t){this.conditionForm={name:"",department_id:"",page:1},this.getManagers()},submitUser:function(){this.addDialogVisible=!0,this.userForm={email:"",name:"",department_id:"",empID:""},this.department=[]},addSubmit:function(){var t=this;return Object(s["a"])(this.userForm).then(function(e){t.getManagers()}).catch(function(t){})},updateUser:function(t){this.updateDialogVisible=!0,this.userForm={email:t.email,name:t.name,department_id:t.department_id,empID:t.empID},this.department=[],this.userId=t.id,t.department.parent_id&&"D1000002"!==t.department.department_id?this.department.push(t.department.parent_id,t.department_id):this.department.push(t.department_id)},updateSubmit:function(){var t=this;return Object(s["z"])(this.userId,this.userForm).then(function(e){t.$message({type:"success",message:o["l"]}),t.getManagers()}).catch(function(t){})},enabledUser:function(t){var e=this,n=1==t.active?0:1;Object(s["d"])(t.id,{active:n}).then(function(t){e.$message({type:"success",message:o["m"]}),e.getManagers()}).catch(function(t){})},deleteUser:function(t){var e=this;this.$confirm(o["_44"],o["b"],{roundButton:!0,confirmButtonText:o["_10"],cancelButtonText:o["_9"],type:"warning",center:!0}).then(function(){Object(s["c"])(t.id).then(function(t){e.getManagers(),e.$message({type:"success",message:o["j"]})}).catch(function(t){})}).catch(function(){e.$message({type:"info",message:o["n"]})})},handleCurrentChange:function(t){this.conditionForm=Object.assign({},this.conditionForm,{page:t}),this.getManagers()}}},l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage"},[n("nav-bar",{attrs:{list:t.nav}}),n("section",{staticClass:"content-container"},[n("el-row",[n("el-col",{attrs:{span:16}},[n("el-form",{ref:"conditionForm",attrs:{inline:!0,model:t.conditionForm}},[n("el-form-item",[n("el-input",{attrs:{placeholder:t.constants.LABEL_NAME},on:{input:t.changeCondition},model:{value:t.conditionForm.name,callback:function(e){t.$set(t.conditionForm,"name",e)},expression:"conditionForm.name"}})],1),n("el-form-item",[n("el-select",{attrs:{placeholder:t.constants.LABEL_SELECT_DIVISION},on:{change:t.changeCondition},model:{value:t.conditionForm.department_id,callback:function(e){t.$set(t.conditionForm,"department_id",e)},expression:"conditionForm.department_id"}},t._l(t.departments,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),n("el-form-item",[n("el-button",{attrs:{round:""},on:{click:function(e){t.resetForm("conditionForm")}}},[t._v(t._s(t.constants.LABEL_EMPTY))])],1)],1)],1),n("el-col",{attrs:{span:8}},[n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-button",{attrs:{type:"primary",round:""},on:{click:t.submitUser}},[t._v(t._s(t.constants.LABEL_ADD_USER))])],1)],1)],1),n("user-dialog",{attrs:{visible:t.addDialogVisible,title:t.constants.LABEL_ADD,userForm:t.userForm,disabled:!1,submit:t.addSubmit,departments:t.adminsDepartments,department:t.department},on:{"update:visible":function(e){t.addDialogVisible=e},"update:userForm":function(e){t.userForm=e}}}),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:t.userTable,stripe:"",height:t.tableHeight}},[t._l(t.tableColumn,function(t){return n("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,"show-overflow-tooltip":!0,align:"center"}})}),n("el-table-column",{attrs:{label:t.constants.LABEL_SCOPE,"show-overflow-tooltip":!0,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.department.name)+"\n          ")]}}])}),n("el-table-column",{attrs:{label:t.constants.LABEL_STATUS,width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s("1"==e.row.active?t.constants.LABEL_ENABLED:t.constants.LABEL_FORBIDDEN)+"\n          ")]}}])}),n("el-table-column",{attrs:{prop:"created_at",label:t.constants.LABEL_CREATED_DATE,width:"180",align:"center"}}),n("el-table-column",{attrs:{fixed:"right",label:t.constants.LABEL_OPERATIONS,align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.updateUser(e.row)}}},[t._v(t._s(t.constants.LABEL_MODIFY))]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.enabledUser(e.row)}}},[t._v(t._s(1==e.row.active?t.constants.LABEL_FORBIDDEN:t.constants.LABEL_ENABLED))]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.deleteUser(e.row)}}},[t._v(t._s(t.constants.LABEL_DEL))])]}}])})],2),n("user-dialog",{attrs:{visible:t.updateDialogVisible,title:t.constants.LABEL_MODIFY,userForm:t.userForm,disabled:!0,submit:t.updateSubmit,departments:t.adminsDepartments,department:t.department},on:{"update:visible":function(e){t.updateDialogVisible=e},"update:userForm":function(e){t.userForm=e}}}),n("br"),n("el-row",{attrs:{type:"flex",justify:"end"}},[n("pagination",{attrs:{total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)],1)},c=[],d=n("XyMi");function u(t){n("P+Uu")}var m=!1,p=u,_="data-v-8d919794",h=null,b=Object(d["a"])(r,l,c,m,p,_,h);e["default"]=b.exports}});
//# sourceMappingURL=8.9bbd9008.js.map