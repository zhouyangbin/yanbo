webpackJsonp([23],{"8g3w":function(t,e){},GhWe:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("EuXz");var s=a("OE2U"),o=a("BHhq"),l=a("xwzc"),r={props:{dialogImport:{type:Boolean,default:!1}},data:function(){return{importTab:"first",importForm:{levels:[]},importRules:{levels:[{type:"array",required:!0,message:"请至少选择一个级别",trigger:"change"}]},constants:{IMPORT_TIPS:s["_6"],IMPORT_RECORDS:s["_4"],EHR_IMPORT:s["w"],WORK_LEVEL:s["_93"],ENUM_LEVELS:s["F"],EXCEL_IMPORT:s["L"],DRAG_FILE:s["v"],CLICK_TO_UPLOAD:s["g"],DOWNLOAD_EXCEL_TEMPLATE:s["u"],CONFIRM:s["h"],CANCEL:s["f"],PATH_IMPORT_BY_EXCEL:l["j"],PATH_EXCEL_TPL:l["a"]},tableData:[],showTable:!1,eHRError:[],showTableEHR:!1}},methods:{initImportLevels:function(){this.importForm.levels=s["F"].filter(function(t){return parseFloat(t.value)>3}).map(function(t){return t.value})},importFiles:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a={evaluation_id:e.$route.params.orgID,"levels[]":e.importForm.levels};Object(o["s"])(a).then(function(t){e.$message({message:s["_5"],type:"success"}),e.close()}).catch(function(t){e.eHRError=t.data.data,e.showTableEHR=!0})})},close:function(){this.$emit("close")},uploadErr:function(t,e,a){var o=JSON.parse(t.message);this.tableData=o.data,this.showTable=!0,this.$notify.error({title:s["J"],message:"".concat(e.name).concat(s["_87"],": ").concat(o.message)})},uploadSuccess:function(t,e,a){this.$notify({title:s["_86"],message:s["_88"],type:"success"}),this.close()},downloadTpl:function(){var t=l["a"];window.open(t,"_blank")}},computed:{uploadData:function(){return{evaluation_id:this.$route.params.orgID}},uploadHeader:function(){return{Authorization:"Bearer ".concat(localStorage.getItem("talToken"))}}},created:function(){this.initImportLevels()}},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"dialogImport",attrs:{width:"500px",visible:t.dialogImport},on:{close:t.close}},[a("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("\n    "+t._s(t.constants.IMPORT_RECORDS)+"\n  ")]),a("div",{staticClass:"importTab"},[a("el-tabs",{model:{value:t.importTab,callback:function(e){t.importTab=e},expression:"importTab"}},[a("el-tab-pane",{attrs:{label:t.constants.EHR_IMPORT,name:"first"}},[a("el-form",{ref:"importForm",staticClass:"importForm",attrs:{"label-width":"80px",rules:t.importRules,model:t.importForm}},[a("el-form-item",{attrs:{label:t.constants.WORK_LEVEL,prop:"levels"}},[a("el-checkbox-group",{model:{value:t.importForm.levels,callback:function(e){t.$set(t.importForm,"levels",e)},expression:"importForm.levels"}},t._l(t.constants.ENUM_LEVELS,function(t){return a("el-checkbox",{key:t.key,attrs:{label:t.value,name:"levels"}})}))],1)],1),t.showTableEHR?a("el-table",{staticClass:"err-table",staticStyle:{width:"100%"},attrs:{"max-height":"250",data:t.eHRError}},[a("el-table-column",{attrs:{prop:"workcode",label:"工号"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),a("el-table-column",{attrs:{prop:"reason",label:"原因"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.reason.join(" "))+"\n            ")]}}])})],1):t._e()],1),a("el-tab-pane",{attrs:{label:t.constants.EXCEL_IMPORT,name:"second"}},[a("el-upload",{staticClass:"uploader",attrs:{"on-success":t.uploadSuccess,"on-error":t.uploadErr,headers:t.uploadHeader,data:t.uploadData,drag:"",action:t.constants.PATH_IMPORT_BY_EXCEL}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v(t._s(t.constants.DRAG_FILE)+"\n            "),a("em",[t._v(t._s(t.constants.CLICK_TO_UPLOAD))])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a("a",{staticStyle:{cursor:"pointer"},on:{click:t.downloadTpl}},[t._v(t._s(t.constants.DOWNLOAD_EXCEL_TEMPLATE))])])]),t.showTable?a("el-table",{staticClass:"err-table",staticStyle:{width:"100%"},attrs:{"max-height":"250",data:t.tableData}},[a("el-table-column",{attrs:{prop:"workcode",label:"工号"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),a("el-table-column",{attrs:{prop:"reason",label:"原因"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.reason.join(" "))+"\n            ")]}}])})],1):t._e()],1)],1),a("span",{staticClass:"tips"},[t._v("\n      "+t._s(t.constants.IMPORT_TIPS)+"\n    ")])],1),"first"===t.importTab?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{attrs:{round:"",size:"medium",type:"primary"},on:{click:function(e){t.importFiles("importForm")}}},[t._v(t._s(t.constants.CONFIRM))]),a("el-button",{staticClass:"btn-reset",attrs:{round:"",size:"medium"},on:{click:t.close}},[t._v(t._s(t.constants.CANCEL))])],1)],1):t._e()])},i=[],c=a("XyMi");function u(t){a("8g3w")}var p=!1,m=u,_="data-v-46aeded9",d=null,b=Object(c["a"])(r,n,i,p,m,_,d);e["default"]=b.exports}});
//# sourceMappingURL=23.d4f8112d.js.map