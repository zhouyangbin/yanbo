(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25c431d3"],{"11e9":function(t,e,n){var r=n("52a7"),a=n("4630"),i=n("6821"),s=n("6a99"),o=n("69a8"),c=n("c69a"),l=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?l:function(t,e){if(t=i(t),e=s(e,!0),c)try{return l(t,e)}catch(n){}if(o(t,e))return a(!r.f.call(t,e),t[e])}},"28a5":function(t,e,n){"use strict";var r=n("aae3"),a=n("cb7c"),i=n("ebd6"),s=n("0390"),o=n("9def"),c=n("5f1b"),l=n("520a"),u=n("79e5"),f=Math.min,d=[].push,h="split",m="length",g="lastIndex",p=4294967295,_=!u(function(){RegExp(p,"y")});n("214f")("split",2,function(t,e,n,u){var b;return b="c"=="abbc"[h](/(b)*/)[1]||4!="test"[h](/(?:)/,-1)[m]||2!="ab"[h](/(?:ab)*/)[m]||4!="."[h](/(.?)(.?)/)[m]||"."[h](/()()/)[m]>1||""[h](/.?/)[m]?function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(a,t,e);var i,s,o,c=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,h=void 0===e?p:e>>>0,_=new RegExp(t.source,u+"g");while(i=l.call(_,a)){if(s=_[g],s>f&&(c.push(a.slice(f,i.index)),i[m]>1&&i.index<a[m]&&d.apply(c,i.slice(1)),o=i[0][m],f=s,c[m]>=h))break;_[g]===i.index&&_[g]++}return f===a[m]?!o&&_.test("")||c.push(""):c.push(a.slice(f)),c[m]>h?c.slice(0,h):c}:"0"[h](void 0,0)[m]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var a=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,a,r):b.call(String(a),n,r)},function(t,e){var r=u(b,t,this,e,b!==n);if(r.done)return r.value;var l=a(t),d=String(this),h=i(l,RegExp),m=l.unicode,g=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(_?"y":"g"),v=new h(_?l:"^(?:"+l.source+")",g),y=void 0===e?p:e>>>0;if(0===y)return[];if(0===d.length)return null===c(v,d)?[d]:[];var w=0,T=0,E=[];while(T<d.length){v.lastIndex=_?T:0;var I,k=c(v,_?d:d.slice(T));if(null===k||(I=f(o(v.lastIndex+(_?0:T)),d.length))===w)T=s(d,T,m);else{if(E.push(d.slice(w,T)),E.length===y)return E;for(var x=1;x<=k.length-1;x++)if(E.push(k[x]),E.length===y)return E;T=w=I}}return E.push(d.slice(w)),E}]})},"2f21":function(t,e,n){"use strict";var r=n("79e5");t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},"55dd":function(t,e,n){"use strict";var r=n("5ca1"),a=n("d8e8"),i=n("4bf8"),s=n("79e5"),o=[].sort,c=[1,2,3];r(r.P+r.F*(s(function(){c.sort(void 0)})||!s(function(){c.sort(null)})||!n("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(i(this)):o.call(i(this),a(t))}})},"5dbc":function(t,e,n){var r=n("d3f4"),a=n("8b97").set;t.exports=function(t,e,n){var i,s=e.constructor;return s!==n&&"function"==typeof s&&(i=s.prototype)!==n.prototype&&r(i)&&a&&a(t,i),t}},"8b97":function(t,e,n){var r=n("d3f4"),a=n("cb7c"),i=function(t,e){if(a(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:i}},9093:function(t,e,n){var r=n("ce10"),a=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,a)}},aa77:function(t,e,n){var r=n("5ca1"),a=n("be13"),i=n("79e5"),s=n("fdef"),o="["+s+"]",c="​",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),f=function(t,e,n){var a={},o=i(function(){return!!s[t]()||c[t]()!=c}),l=a[t]=o?e(d):s[t];n&&(a[n]=l),r(r.P+r.F*o,"String",a)},d=f.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},aae3:function(t,e,n){var r=n("d3f4"),a=n("2d95"),i=n("2b4c")("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==a(t))}},b833:function(t,e,n){"use strict";var r=n("d113"),a=n.n(r);a.a},c5f6:function(t,e,n){"use strict";var r=n("7726"),a=n("69a8"),i=n("2d95"),s=n("5dbc"),o=n("6a99"),c=n("79e5"),l=n("9093").f,u=n("11e9").f,f=n("86cc").f,d=n("aa77").trim,h="Number",m=r[h],g=m,p=m.prototype,_=i(n("2aeb")(p))==h,b="trim"in String.prototype,v=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():d(e,3);var n,r,a,i=e.charCodeAt(0);if(43===i||45===i){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+e}for(var s,c=e.slice(2),l=0,u=c.length;l<u;l++)if(s=c.charCodeAt(l),s<48||s>a)return NaN;return parseInt(c,r)}}return+e};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof m&&(_?c(function(){p.valueOf.call(n)}):i(n)!=h)?s(new g(v(e)),n,m):v(e)};for(var y,w=n("9e1e")?l(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),T=0;w.length>T;T++)a(g,y=w[T])&&!a(m,y)&&f(m,y,u(g,y));m.prototype=p,p.constructor=m,n("2aba")(r,h,m)}},d113:function(t,e,n){},ec92:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"target-settings"},[n("nav-bar",{attrs:{list:t.nav}}),n("div",[n("detail-header",{attrs:{"user-info":t.userInfo,self:!0}}),n("el-row",[t._l(t.allTarget,function(e,r){return n("el-row",{key:r,staticClass:"target-detail"},[n("el-row",{staticClass:"target-detail-title"},[n("span",{staticClass:"target-title"},[t._v(t._s(e.type))]),n("span",{staticClass:"target-weight"},[t._v(t._s(t.constants.TARGET_WEIGH)+t._s(e.weight)+"%")])]),n("el-form",{ref:"form"+r,refInFor:!0,attrs:{model:e}},[n("el-table",{attrs:{data:e.table,border:"","header-cell-style":{backgroundColor:"#F5F6F7",color:"#303133"}}},[n("el-table-column",{attrs:{label:t.constants.TARGET_WEIGH,width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(r){return[e.isMoney?n("div",[t._v("\n                  "+t._s(Math.ceil(r.row.weights))+"%\n                ")]):t._e(),e.isMoney?t._e():n("el-form-item",{attrs:{prop:"table."+r.$index+".weights",rules:t.rules.weights}},[n("el-input",{attrs:{type:"number",size:"small",oninput:"if(value > 100)value = 100;if(value < 0)value = 0"},model:{value:r.row.weights,callback:function(e){t.$set(r.row,"weights",t._n(e))},expression:"scope.row.weights"}},[n("template",{slot:"append"},[t._v("%")])],2)],1)]}}],null,!0)}),e.isMoney?n("el-table-column",{attrs:{label:t.constants.TARGET_NAME,"min-width":"240",align:"center",prop:"target"}}):t._e(),e.isMoney?t._e():n("el-table-column",{attrs:{label:t.constants.TARGET_NAME,"min-width":"240",align:"center","render-header":t.changeLabel,prop:"target"},scopedSlots:t._u([{key:"default",fn:function(a){return[n("el-form-item",{attrs:{prop:"table."+a.$index+".target",rules:t.rules.target}},[n("div",{staticClass:"flex"},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:12}},model:{value:a.row.target,callback:function(e){t.$set(a.row,"target",e)},expression:"scope.row.target"}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.table.length>1,expression:"targetItem.table.length > 1"}],staticClass:"el-icon-delete delete-target",on:{click:function(e){return t.deleteTarget(r,""+a.$index)}}})],1)])]}}],null,!0)}),void 0!==e.table[0].content?n("el-table-column",{attrs:{label:t.constants.TASK_DESCRIPTION,"min-width":"300","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(r){return[e.isMoney?n("div",[t._v(t._s(r.row.content))]):t._e(),e.isMoney?t._e():n("el-form-item",{attrs:{prop:"table."+r.$index+".content",rules:t.rules.content}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:12}},model:{value:r.row.content,callback:function(e){t.$set(r.row,"content",e)},expression:"scope.row.content"}})],1)]}}],null,!0)}):t._e(),n("el-table-column",{attrs:{label:t.constants.YARD_STICK,"min-width":"300","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(r){return[e.isMoney?n("ul",t._l(r.row.metrics,function(e,r){return n("li",{key:r,staticClass:"flex"},[n("el-col",{staticClass:"measure-title"},[e.is_required?n("span",{staticClass:"is-required"},[t._v("*")]):t._e(),n("span",[t._v(" "+t._s(e.name))])]),n("el-col",[t._v(t._s(e.content))])],1)}),0):t._e(),t._l(r.row.metrics,function(a,i){return n("el-row",{key:i},[e.isMoney?t._e():n("el-form-item",{attrs:{label:a.name,"label-width":"130px",prop:"table."+r.$index+".metrics."+i+".content",rules:a.is_required?t.metricsRules.content:{}}},[n("el-input",{attrs:{type:"textarea",autosize:""},model:{value:a.content,callback:function(e){t.$set(a,"content",e)},expression:"item.content"}})],1)],1)})]}}],null,!0)})],1),!e.isMoney&&t.getTableLen(r)<=4?n("el-button",{staticClass:"add-target",attrs:{icon:"el-icon-plus"},on:{click:function(e){return t.addTarget(r)}}},[t._v(t._s(t.constants.ADD_TARGET_LINE))]):t._e()],1)],1)}),n("ul",{staticClass:"sub-total"},[n("li",[t._v("\n          "+t._s(t.constants.FINANCE_DIMENSIONALITY_SUBTOTAL)+"   "+t._s(this.handleSubTotal("finance"))+"%\n        ")]),n("li",[t._v("\n          工作维度小计   "+t._s(this.handleSubTotal("work"))+"%\n        ")]),n("li",[t._v("\n          团队维度小计   "+t._s(this.handleSubTotal("team"))+"%\n        ")]),n("li",{staticClass:"performance-total"},[t._v("\n          业绩维度合计   "+t._s(this.handleSubTotal("finance")+this.handleSubTotal("work")+this.handleSubTotal("team"))+"%\n        ")])])],2),n("el-row",{staticClass:"footer-button"},[n("el-button",{staticClass:"submit-button",on:{click:t.submitForm}},[t._v("提交")]),n("el-button",{staticClass:"tempeorary-memory",on:{click:t.temporaryMemory}},[t._v("暂存")]),n("el-button",{on:{click:t.returnList}},[t._v("返回")])],1),t.userInfo.opinion&&1===t.userInfo.stage&t.self?n("el-row",{staticClass:"footer-button"},[n("el-button",{staticClass:"submit-button",on:{click:t.submitForm}},[t._v("提交")]),n("el-button",{staticClass:"tempeorary-memory",on:{click:t.temporaryMemory}},[t._v("暂存")]),n("el-button",{on:{click:t.checkExamine}},[t._v("\n        "+t._s(t.constants.CHECK_EXAMINE_LOG)+"\n      ")]),n("el-button",{on:{click:t.returnList}},[t._v("返回")])],1):t._e()],1),n("examine-detail",{attrs:{"is-examine-dialog":t.isExamineDialog,perforamnce_user_id:t.userInfo.perforamnce_user_id},on:{close:t.closeExamine}})],1)},a=[],i=(n("28a5"),n("456d"),n("55dd"),n("7f7f"),n("c5f6"),n("ac6a"),n("38fb")),s=n("c9f1"),o=n("fea5"),c=(n("5c96"),{data:function(){return{arrs:[0,1,2],constants:{TARGET_WEIGH:i["Ue"],TARGET_NAME:i["Re"],TASK_DESCRIPTION:i["Ve"],YARD_STICK:i["nf"],ADD_TARGET_LINE:i["g"],FINANCE_DIMENSIONALITY_SUBTOTAL:i["Tb"],CHECK_EXAMINE_LOG:i["E"]},userId:this.$route.params.uid,nav:[{label:i["wd"],href:s["l"]},{label:i["Qe"],active:!0}],userInfo:{performance_name:"",stage:0,opinion:"",avatar:"",name:"",workcode:"",superior_name:"",superior_workcode:"",executive_type:"",department_name:"",cycle:"",indicator_setting_end_time:"",perforamnce_user_id:this.$route.params.uid},allTarget:[],isExamineDialog:!1,rules:{weights:[{required:!0,message:"权重不能为空",trigger:"blur"}],target:[{required:!0,message:"指标名称不能为空",trigget:"blur"}],content:[{required:!0,message:"具体工作/任务描述不能为空",trigger:"blur"}]},metricsRules:{content:[{required:!0,message:"请输入衡量标准",trigger:"blur"}]}}},components:{"nav-bar":function(){return n.e("chunk-d5094d72").then(n.bind(null,"3208"))},"detail-header":function(){return n.e("chunk-745d1c87").then(n.bind(null,"58f1"))},"examine-detail":function(){return n.e("chunk-50f9fdaa").then(n.bind(null,"1622"))}},methods:{getTableLen:function(t){return this.allTarget[t].table.length},handleSubTotal:function(t){var e=0;return this.allTarget.forEach(function(n){n.basicType===t&&n.table.forEach(function(t){""!==t.weights&&(e+=Number(t.weights))})}),e},changeData:function(t){return t.forEach(function(t){t.table.forEach(function(t){t.targets.forEach(function(e){t.target=e.target,t.metrics.forEach(function(t){t.content=e[t.key]})})})}),t},closeExamine:function(){this.isExamineDialog=!1},checkExamine:function(){this.isExamineDialog=!0},changeLabel:function(t,e){var n=e.column;return t("div",[t("span",n.label),t("br"),t("span","（最多可填写"),t("span",{style:{color:"red"}},5),t("span","项）")])},getUserInfo:function(){var t=this,e={performance_user_id:this.$route.params.uid};Object(o["ob"])(e).then(function(e){var n=e.performance_name,r=e.stage,a=e.opinion,i=e.avatar,s=e.name,o=e.workcode,c=e.superior_name,l=e.superior_workcode,u=e.executive_type,f=e.department_name,d=e.cycle,h=e.indicator_setting_end_time;t.userInfo={performance_name:n,stage:r,opinion:a,avatar:i,name:s,workcode:o,superior_name:c,superior_workcode:l,executive_type:u,department_name:f,cycle:d,indicator_setting_end_time:h,perforamnce_user_id:t.$route.params.uid}}).catch(function(){})},getWrokAndTeamTarget:function(){var t=this,e={performance_id:this.$route.params.id,performance_user_id:this.$route.params.uid};Object(o["Kb"])(e).then(function(e){var n=void 0!==e.team,r=void 0!==e.work,a=void 0!==e.finance;t.allTarget=[];var i=[{content:"",disqualification:"",excellence:"",good:"",id:"",outstanding:"",performance_id:"",performance_user_id:"",target:"",to_be_improved:"",type:"",weights:""}];if(n){var s=e.team;void 0==s.targets[0]&&(s.targets=i),s.template_columns={content:s.targets[0].content,weights:s.targets[0].weights,metrics:s.template_columns.metrics,targets:s.targets};var o=[{basicType:"team",isMoney:0,sort:s.sort,type:s.name,weight:s.weight,table:[s.template_columns]}];t.changeData(o),t.$set(t.allTarget,s.sort-1,o[0])}if(r){var c=e.work;void 0==c.targets[0]&&(c.targets=i),c.template_columns={content:c.targets[0].content,weights:c.targets[0].weights,metrics:c.template_columns.metrics,targets:c.targets};var l=[{basicType:"work",isMoney:0,sort:c.sort,type:c.name,weight:c.weight,table:[c.template_columns]}];t.changeData(l),t.$set(t.allTarget,c.sort-1,l[0])}if(a){var u=e.finance;void 0==u.targets[0]&&(u.targets=i),u.template_columns={content:u.targets[0].content,weights:u.targets[0].weights,metrics:u.template_columns.metrics,targets:u.targets};var f=[{basicType:"finance",isMoney:1,sort:u.sort,type:u.name,weight:u.weight,table:[u.template_columns]}];t.changeData(f),t.$set(t.allTarget,u.sort-1,f[0])}}).catch(function(){})},handleSubmitData:function(){var t=this.allTarget,e=[],n=[];t.forEach(function(t){t.table.forEach(function(r){var a={};r.metrics.forEach(function(t){a[t.key]=t.content}),a.type=t.type,a.weight=t.weight,a.specific_job=r.content,a.indicator_name=r.target,"team"==t.basicType?e.push(a):"work"==t.basicType&&n.push(a)})});var r={target:{performance_id:this.$route.params.id,performance_user_id:this.$route.params.uid,team:e,work:n}};return r},submitForm:function(){for(var t=this,e=Object.keys(this.$refs),n=0,r="",a=0;a<e.length;a++){var i=0;if(this.$refs[e[a]][0].validate(function(t,e){t?n++:(r=Object.keys(e),i=1)}),i){var c=r[0].split("."),l=0,u="";return 3===c.length?"weights"===c[2]?u="权重":"target"===c[2]?u="指标名称":"content"===c[2]&&(u="具体工作/任务描述"):5===c.length&&(u=this.allTarget[a].table[l].metrics[c[3]].name),l=parseInt(c[1]),this.$message.error("".concat(this.allTarget[a].type,"第").concat(l+1,"行").concat(u,"不能为空")),!1}}for(var f=0;f<this.allTarget.length;f++)if(Math.ceil(this.allTarget[f].weight)!==this.handleSubTotal(this.allTarget[f].basicType))return this.$message.error("".concat(this.allTarget[f].type,"权重之和不等于").concat(this.allTarget[f].weight,"%, 请检查")),!1;n===e.length&&this.$confirm("是否确认提交指标?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){Object(o["uc"])(t.$route.params.uid,t.handleSubmitData()).then(function(e){t.$router.push(Object(s["fb"])(t.$route.params.id,t.$route.params.uid)),localStorage.clearItem(t.userId)}).catch(function(){})}).catch(function(){})},temporaryMemory:function(){var t=this;Object(o["qc"])(this.userId,this.allTarget).then(function(e){localStorage.setItem(t.userId,1),t.$message({type:"success",message:"暂存成功"})}).catch(function(){})},returnList:function(){var t=this;Object(o["qc"])(this.$route.params.uid,this.allTarget).then(function(e){localStorage.setItem(t.userId,1),t.$router.push("/employee/my")}).catch(function(){})},addTarget:function(t){var e=this,n={performance_id:this.$route.params.id,performance_user_id:this.$route.params.uid};Object(o["zb"])(n).then(function(n){e.allTarget[t].table.push(n)})},deleteTarget:function(t,e){this.allTarget[t].table.splice(e,1)},getUserMsg:function(){var t=this,e=this.$route.params.uid;Object(o["hb"])(e).then(function(e){for(var n=0;n<e.length;n++)e[n].isMoney=Number(e[n].isMoney);t.allTarget=e}).catch(function(){})}},created:function(){this.getUserInfo(),void 0==localStorage.getItem(this.userId)?this.getWrokAndTeamTarget():this.getUserMsg()}}),l=c,u=(n("b833"),n("2877")),f=Object(u["a"])(l,r,a,!1,null,"46bf7caa",null);e["default"]=f.exports},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);