webpackJsonp([42],{"4bgW":function(e,t,r){"use strict";var n=r("Biqn"),i=r.n(n),o={props:{visible:{type:Boolean,default:!1},data:{type:Array,default:function(){return[]}},checkedNodes:{type:Array,default:function(){return[]}},exclusive:{type:Boolean,default:!1}},data:function(){return{defaultProps:{label:"name"},filterText:"",tree:this.data}},methods:{filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},afterEnter:function(e){e.style.width="30%"},beforeLeave:function(e){e.style.width="0px",e.style.padding="0px"},treeChange:function(e,t,r){var n=this.$refs.tree.getCheckedNodes();if(this.exclusive){if(t){var i=this.findRoot(e.id).id;this.disabledOtherBranch(i)}0==n.length&&this.enableAll()}this.$emit("update:checkedNodes",n.map(function(e){var t=e.name,r=e.id;return{name:t,id:r}}))},findRoot:function(e){for(var t={},r=0;r<this.data.length;r++)if(t=this.data[r],this.findNode(e,this.data[r]))return t},findNode:function(e,t){if(t.id==e)return!0;var r=t.children;if(r&&r.length>0)for(var n=0;n<r.length;n++)if(this.findNode(e,r[n]))return!0;return!1},disabledOtherBranch:function(e){for(var t=this.tree,r=0;r<t.length;r++)t[r].id!=e&&(t[r]=this.disableNode(t[r],!0),this.$set(t,r,i()({},t[r])))},disableNode:function(e,t){var r=this;e.disabled=t;var n=e.children;return n&&n.length>0&&(e.children=n.map(function(e){return r.disableNode(e,t)})),e},enableAll:function(){for(var e=this.tree,t=0;t<e.length;t++)e[t]=this.disableNode(e[t],!1),this.$set(e,t,i()({},e[t]))},outside:function(){this.$emit("update:visible",!1)}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},computed:{checkedKeys:function(){return this.checkedNodes.map(function(e){var t=e.department_id;return t})},treeOps:function(){return this.tree||this.data}},directives:{"click-outside":{bind:function(e,t,r){if("function"!==typeof t.value){var n=r.context.name,i="[Vue-click-outside:] provided expression '".concat(t.expression,"' is not a function, but has to be");n&&(i+="Found in component '".concat(n,"'")),console.warn(i)}var o=t.modifiers.bubble,a=function(r){(o||!e.contains(r.target)&&e!==r.target)&&t.value(r)};e.__vueClickOutside__=a,document.addEventListener("click",a)},unbind:function(e,t){document.removeEventListener("click",e.__vueClickOutside__),e.__vueClickOutside__=null}}}},a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"fade"},on:{"before-leave":e.beforeLeave,"after-enter":e.afterEnter}},[e.visible?r("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.outside,expression:"outside"}],staticClass:"objectTree-container"},[r("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),r("el-tree",{ref:"tree",attrs:{props:e.defaultProps,"default-checked-keys":e.checkedKeys,"node-key":"id","filter-node-method":e.filterNode,"show-checkbox":"","empty-text":"暂无数据",data:e.treeOps},on:{"check-change":e.treeChange}})],1):e._e()])},c=[],s=r("XyMi");function u(e){r("XaDD")}var d=!1,l=u,f="data-v-a827dace",h=null,m=Object(s["a"])(o,a,c,d,l,f,h);t["a"]=m.exports},"EEY+":function(e,t){},XaDD:function(e,t){},aTXZ:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("OE2U"),i=r("4bgW"),o=r("BHhq"),a={props:{visible:{type:Boolean,default:!1},currentInfo:{type:Object,default:function(){return{}}}},data:function(){var e=this,t=function(t,r,n){0==e.cultureCheckedNodes.length?n("请选择文化管理范围"):n()},r=function(t,r,n){0==e.performanceCheckedNodes.length?n("请选择绩效管理范围"):n()};return{showCultureTree:!1,cultureCheckedNodes:this.currentInfo.culture_departments||[],showPerformanceTree:!1,performanceCheckedNodes:this.currentInfo.achievement_departments||[],cultureDepartmentTree:[],performanceDepartmentTree:[],filterText:"",constants:{MODIFY:n["_61"],CONFIRM:n["l"],CANCEL:n["j"]},bindRules:{culture:[{validator:t,trigger:"change"}],performance:[{validator:r,trigger:"change"}]},bindForm:{culture:"",performance:""}}},beforeDestroy:function(){this.$refs["bindForm"].resetFields()},components:{"dp-panel":i["a"]},computed:{cultrueSelectedNames:function(){return this.cultureCheckedNodes.map(function(e){var t=e.name;return t}).join(", ")},performanceSelectedNames:function(){return this.performanceCheckedNodes.map(function(e){var t=e.name;return t}).join(", ")}},methods:{submit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var r={culture_department_ids:t.cultureCheckedNodes.map(function(e){return e.id}),achievement_department_ids:t.performanceCheckedNodes.map(function(e){return e.id})};Object(o["E"])(t.currentInfo.id,r).then(function(e){t.close()})}})},close:function(){this.$emit("update:visible",!1)}},created:function(){var e=this;Object(o["g"])().then(function(t){var r=t.cultureDepartment,n=t.achievementDepartmentTree;e.cultureDepartmentTree=r?[r]:[],e.performanceDepartmentTree=n?[n]:[]}).catch(function(e){})}},c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"bindDPDialog",attrs:{width:"650px",visible:e.visible},on:{close:e.close}},[r("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[e._v("\n    "+e._s(e.constants.MODIFY)+"\n  ")]),r("div"),r("el-form",{ref:"bindForm",staticClass:"bindForm",attrs:{inline:!0,rules:e.bindRules,model:e.bindForm}},[r("el-form-item",{attrs:{prop:"culture",label:"文化范围"}},[r("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择事业部",icon:"caret-bottom",readonly:"readonly"},nativeOn:{click:function(t){e.showPerformanceTree=!1,e.showCultureTree=!e.showCultureTree}},model:{value:e.cultrueSelectedNames,callback:function(t){e.cultrueSelectedNames=t},expression:"cultrueSelectedNames"}})],1),r("el-form-item",{attrs:{prop:"performance",label:"绩效范围"}},[r("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择事业部",icon:"caret-bottom",readonly:"readonly"},nativeOn:{click:function(t){e.showCultureTree=!1,e.showPerformanceTree=!e.showPerformanceTree}},model:{value:e.performanceSelectedNames,callback:function(t){e.performanceSelectedNames=t},expression:"performanceSelectedNames"}})],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-button",{attrs:{round:"",size:"medium",type:"primary"},on:{click:function(t){e.submit("bindForm")}}},[e._v(e._s(e.constants.CONFIRM))]),r("el-button",{staticClass:"btn-reset",attrs:{round:"",size:"medium"},on:{click:e.close}},[e._v(e._s(e.constants.CANCEL))])],1)],1),e.showCultureTree?r("dp-panel",{key:"showCultureTree",attrs:{checkedNodes:e.cultureCheckedNodes,visible:e.showCultureTree,data:e.cultureDepartmentTree},on:{"update:checkedNodes":function(t){e.cultureCheckedNodes=t},"update:visible":function(t){e.showCultureTree=t}}}):e._e(),e.showPerformanceTree?r("dp-panel",{key:"showPerformanceTree",attrs:{checkedNodes:e.performanceCheckedNodes,visible:e.showPerformanceTree,data:e.performanceDepartmentTree},on:{"update:checkedNodes":function(t){e.performanceCheckedNodes=t},"update:visible":function(t){e.showPerformanceTree=t}}}):e._e()],1)},s=[],u=r("XyMi");function d(e){r("EEY+")}var l=!1,f=d,h="data-v-64015091",m=null,p=Object(u["a"])(a,c,s,l,f,h,m);t["default"]=p.exports}});
//# sourceMappingURL=42.5bf08483.js.map