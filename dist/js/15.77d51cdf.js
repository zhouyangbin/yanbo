webpackJsonp([15],{ASoR:function(t,e){},Q8KN:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Biqn"),a=n.n(i),o=n("OE2U"),s=n("BHhq"),r={components:{"nav-bar":function(){return n.e(25).then(n.bind(null,"PI/7"))},"user-dialog":function(){return n.e(43).then(n.bind(null,"43ll"))},pagination:function(){return n.e(26).then(n.bind(null,"734F"))},"bind-dialog":function(){return n.e(44).then(n.bind(null,"aTXZ"))}},data:function(){return{nav:[{label:o["_124"],active:!0}],constants:{LABEL_NAME:o["_38"],ROLE:o["_99"],LABEL_STATUS:o["_52"],LABEL_CREATED_DATE:o["_30"],LABEL_OPERATIONS:o["_39"],LABEL_MODIFY:o["_37"],LABEL_FORBIDDEN:o["_34"],LABEL_ENABLED:o["_33"],LABEL_DEL:o["_31"],LABEL_ADD:o["_26"],LABEL_ADD_USER:o["_27"],LABEL_EMPTY:o["_32"],LABEL_SELECT_DIVISION:o["_48"],BIND_DEPARTMENT:o["j"]},conditionForm:{name:"",department_id:"",page:1},total:0,departments:[],bindDialogVisible:!1,addDialogVisible:!1,updateDialogVisible:!1,userForm:{email:"",name:"",roles:[],empID:""},userId:"",tableColumn:[{prop:"name",label:o["_38"],width:"150"},{prop:"email",label:o["_55"],width:""}],userTable:[],tableLoading:!0,tableHeight:"calc(100% - 61px - 40px)",selectedUser:{}}},created:function(){this.getManagers(),this.getDepartments()},methods:{getManagers:function(){var t=this,e=a()({},this.conditionForm);Object(s["q"])(e).then(function(e){t.tableLoading=!1,e&&(t.total=e.total,t.userTable=e.data)}).catch(function(e){t.tableLoading=!1})},getDepartments:function(){var t=this;Object(s["k"])().then(function(e){e.map(function(t){t.label=t.name,t.value=t.department_id}),t.departments=e}).catch(function(t){})},changeCondition:function(){this.conditionForm=Object.assign({},this.conditionForm,{page:1}),this.getManagers()},resetForm:function(t){this.conditionForm={name:"",department_id:"",page:1},this.getManagers()},submitUser:function(){this.addDialogVisible=!0,this.userForm={email:"",name:"",roles:[],empID:""}},addSubmit:function(){var t=this,e=this.userForm,n=e.email,i=e.roles;return Object(s["a"])({email:n,role_ids:i.map(function(t){return t.id})}).then(function(e){t.addDialogVisible=!1,t.getManagers()}).catch(function(t){})},updateUser:function(t){this.updateDialogVisible=!0,this.userForm={email:t.email,name:t.name,empID:t.empID,roles:t.roles||[]},this.userId=t.id},updateSubmit:function(){var t=this,e=this.userForm.roles;return Object(s["_7"])(this.userId,{role_ids:e.map(function(t){return t.id})}).then(function(e){t.$message({type:"success",message:o["t"]}),t.userId="",t.updateDialogVisible=!1,t.getManagers()}).catch(function(t){})},enabledUser:function(t){var e=this,n=1^t.active;Object(s["_7"])(t.id,{active:n}).then(function(n){e.$message({type:"success",message:1==t.active?"禁用成功":"启用成功"}),e.getManagers()}).catch(function(t){})},deleteUser:function(t){var e=this;this.$confirm(o["_56"],o["g"],{roundButton:!0,confirmButtonText:o["_29"],cancelButtonText:o["_28"],type:"warning",center:!0}).then(function(){Object(s["g"])(t.id).then(function(t){e.getManagers(),e.$message({type:"success",message:o["r"]})}).catch(function(t){})}).catch(function(){e.$message({type:"info",message:o["u"]})})},handleCurrentChange:function(t){this.conditionForm=Object.assign({},this.conditionForm,{page:t}),this.getManagers()},bind:function(t){this.selectedUser=t,this.bindDialogVisible=!0}},watch:{bindDialogVisible:function(t){t||this.getManagers()}}},l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage"},[n("nav-bar",{attrs:{list:t.nav}}),n("section",{staticClass:"content-container"},[n("el-row",[n("el-col",{attrs:{span:16}},[n("el-form",{ref:"conditionForm",attrs:{inline:!0,model:t.conditionForm}},[n("el-form-item",[n("el-input",{attrs:{placeholder:t.constants.LABEL_NAME},on:{input:t.changeCondition},model:{value:t.conditionForm.name,callback:function(e){t.$set(t.conditionForm,"name",e)},expression:"conditionForm.name"}})],1),n("el-form-item",[n("el-select",{attrs:{placeholder:t.constants.LABEL_SELECT_DIVISION},on:{change:t.changeCondition},model:{value:t.conditionForm.department_id,callback:function(e){t.$set(t.conditionForm,"department_id",e)},expression:"conditionForm.department_id"}},t._l(t.departments,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),n("el-form-item",[n("el-button",{attrs:{round:""},on:{click:function(e){t.resetForm("conditionForm")}}},[t._v(t._s(t.constants.LABEL_EMPTY))])],1)],1)],1),n("el-col",{attrs:{span:8}},[n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-button",{attrs:{type:"primary",round:""},on:{click:t.submitUser}},[t._v(t._s(t.constants.LABEL_ADD_USER))])],1)],1)],1),t.addDialogVisible?n("user-dialog",{attrs:{visible:t.addDialogVisible,title:t.constants.LABEL_ADD,userForm:t.userForm,disabled:!1,submit:t.addSubmit},on:{"update:visible":function(e){t.addDialogVisible=e},"update:userForm":function(e){t.userForm=e}}}):t._e(),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:t.userTable,stripe:"",height:t.tableHeight}},[t._l(t.tableColumn,function(t){return n("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,"show-overflow-tooltip":!0,align:"center"}})}),n("el-table-column",{attrs:{label:t.constants.ROLE,"show-overflow-tooltip":!0,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.roles.map(function(t){return t.name}).join(", "))+"\n        ")]}}])}),n("el-table-column",{attrs:{label:t.constants.LABEL_STATUS,width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s("1"==e.row.active?t.constants.LABEL_ENABLED:t.constants.LABEL_FORBIDDEN)+"\n        ")]}}])}),n("el-table-column",{attrs:{prop:"created_at",label:t.constants.LABEL_CREATED_DATE,width:"180",align:"center"}}),n("el-table-column",{attrs:{fixed:"right",label:t.constants.LABEL_OPERATIONS,align:"center",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.updateUser(e.row)}}},[t._v(t._s(t.constants.LABEL_MODIFY))]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.enabledUser(e.row)}}},[t._v(t._s(1==e.row.active?t.constants.LABEL_FORBIDDEN:t.constants.LABEL_ENABLED))]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.deleteUser(e.row)}}},[t._v(t._s(t.constants.LABEL_DEL))]),n("el-button",{class:{disable:!e.row.has_achievement_permission&&!e.row.has_culture_permission},attrs:{type:"text",size:"small"},on:{click:function(n){t.bind(e.row)}}},[t._v(t._s(t.constants.BIND_DEPARTMENT))])]}}])})],2),t.updateDialogVisible?n("user-dialog",{attrs:{visible:t.updateDialogVisible,title:t.constants.LABEL_MODIFY,userForm:t.userForm,disabled:!0,submit:t.updateSubmit},on:{"update:visible":function(e){t.updateDialogVisible=e},"update:userForm":function(e){t.userForm=e}}}):t._e(),n("br"),t.bindDialogVisible?n("bind-dialog",{attrs:{currentInfo:t.selectedUser,visible:t.bindDialogVisible},on:{"update:visible":function(e){t.bindDialogVisible=e}}}):t._e(),n("el-row",{attrs:{type:"flex",justify:"end"}},[n("pagination",{attrs:{currentPage:t.conditionForm.page,total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)],1)},c=[],u=n("XyMi");function d(t){n("ASoR")}var m=!1,b=d,_="data-v-3cc0aa09",p=null,g=Object(u["a"])(r,l,c,m,b,_,p);e["default"]=g.exports}});
//# sourceMappingURL=15.77d51cdf.js.map