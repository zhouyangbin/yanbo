(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a049a932"],{"048a":function(e,t,s){},2908:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"culture-hr-details-modify-page"},[s("nav-bar",{attrs:{list:e.nav}}),s("br"),s("section",{staticClass:"content-container",staticStyle:{padding:"40px"}},[s("basic-info",{attrs:{data:e.basicInfo}}),s("br"),s("hr"),s("br"),s("rule-text",{attrs:{text:e.constants.MY_MEMBER_RULE}}),s("br"),s("br"),s("div",[s("h3",[e._v(e._s(e.constants.ADVANTAGE)+":")]),s("case-area",{attrs:{readOnly:e.readOnly},model:{value:e.advantage,callback:function(t){e.advantage=t},expression:"advantage"}})],1),s("br"),s("div",[s("h3",[e._v(e._s(e.constants.PROMOTION)+":")]),s("case-area",{attrs:{readOnly:e.readOnly},model:{value:e.promotion,callback:function(t){e.promotion=t},expression:"promotion"}})],1),s("br"),s("section",{staticClass:"mark"},[s("el-row",{attrs:{align:"middle",type:"flex"}},[s("el-col",{staticStyle:{padding:"20px","border-right":"1px solid #979797"}},[s("div",{staticClass:"mark-label"},[e._v("\n            自评分数\n          ")]),s("grade-items",{attrs:{items:e.scores},model:{value:e.selectGradeItem,callback:function(t){e.selectGradeItem=t},expression:"selectGradeItem"}})],1),s("el-col",{staticStyle:{"padding-left":"50px"}},e._l(e.reasons,function(t,a){return s("div",{key:a,staticClass:"mark-reason"},[s("div",[e._v("\n              "+e._s(a+3)+"分理由:\n            ")]),s("div",[e._v("\n              "+e._s(t)+"\n            ")])])}))],1)],1),s("br"),s("div",{staticClass:"mark-flag-container"},[s("div",{staticClass:"mark-section"},[s("div",{staticClass:"mark-label"},[e._v("\n          为"+e._s(e.employee_name)+"的"+e._s(e.scores[e.selectGradeItem].question_name)+"项目评分\n        ")]),s("br"),s("grade-slider",{attrs:{readOnly:e.readOnly},model:{value:e.scores[e.selectGradeItem].superior_score,callback:function(t){e.$set(e.scores[e.selectGradeItem],"superior_score",t)},expression:"scores[selectGradeItem].superior_score"}})],1),s("div",{staticStyle:{width:"20px"}}),s("div",{staticClass:"flag-section"},[s("div",{staticClass:"mark-label"},[e._v("\n          为"+e._s(e.employee_name)+"设置等级标签\n        ")]),s("br"),s("level-selector",{attrs:{pre:e.preLv,disabled:e.readOnly},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}})],1)]),s("br"),e.scores[e.selectGradeItem].superior_score!=e.scores[e.selectGradeItem].score?s("div",[s("case-area",{attrs:{readOnly:e.readOnly},model:{value:e.scores[e.selectGradeItem].superior_case,callback:function(t){e.$set(e.scores[e.selectGradeItem],"superior_case",t)},expression:"scores[selectGradeItem].superior_case"}}),s("br")],1):e._e(),e.forReject?e._e():s("div",[s("case-area",{attrs:{readOnly:e.readOnly,placeholder:"请填写修改理由"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}}),s("br")],1),e.readOnly?e._e():s("el-row",{attrs:{type:"flex",justify:"end"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},r=[],n=(s("ac6a"),s("7f7f"),s("c9f1")),c=s("38fb"),o=s("fea5"),i={data:function(){return{basicInfo:{name:"",workcode:""},employee_name:"",readOnly:!1,advantage:"",promotion:"",selectGradeItem:0,level:"",preLv:"",reason:"",forReject:!0,lv_necessary:!0,scores:[{cases:[]}],nav:[{label:c["Db"],href:n["y"]},{label:c["Fb"],href:Object(n["A"])(this.$route.params.id)},{label:c["id"],href:Object(n["z"])(this.$route.params.id,this.$route.params.orgID)},{label:c["Bb"],href:Object(n["v"])(this.$route.params.id,this.$route.params.orgID,this.$route.params.uid)},{label:"评分修改",active:!0}],constants:{MY_MEMBER_RULE:c["Wc"],ADVANTAGE:c["d"],PROMOTION:c["vd"]}}},components:{"nav-bar":function(){return s.e("chunk-5a85c387").then(s.bind(null,"3208"))},"basic-info":function(){return s.e("chunk-09165fb0").then(s.bind(null,"eb39"))},"rule-text":function(){return s.e("chunk-f91b1ecc").then(s.bind(null,"6c37"))},"grade-items":function(){return s.e("chunk-d2a305a8").then(s.bind(null,"da3f"))},"grade-slider":function(){return s.e("chunk-617cc2fc").then(s.bind(null,"aa29"))},"level-selector":function(){return s.e("chunk-04bd9d4f").then(s.bind(null,"7f4e"))},"case-area":function(){return s.e("chunk-5bf376a3").then(s.bind(null,"b5ec"))}},computed:{reasons:function(){return this.scores[this.selectGradeItem].self_cases}},methods:{getMemberDetail:function(){var e=this;Object(o["V"])(this.$route.params.uid).then(function(t){var s=t.advantage,a=t.promotion,r=t.scores,n=t.name,o=t.workcode,i=(t.end_time,t._271_level),l=(t.status,t._271_is_necessary);e.advantage=s,e.promotion=a,e.employee_name=n,e.basicInfo={name:n,workcode:o},e.lv_necessary=1==l,e.preLv=e.level=c["Ic"][i].toLowerCase(),e.scores=r.map(function(e){return e.score=e.self_score,delete e.self_score,e})})},submit:function(){var e=this,t=this.validate();if(t){var s=this.composePostData();this.forReject?Object(o["yb"])(this.$route.params.uid,s).then(function(t){e.$message({message:"修改成功",type:"success"}),e.$router.go(-1)}).catch(function(e){}):(s.reason=this.reason,Object(o["fb"])(this.$route.params.uid,s).then(function(t){e.$message({message:"修改成功",type:"success"}),e.$router.go(-1)}).catch(function(e){}))}},validate:function(){if(this.advantage&&this.promotion)if(this.level||!this.lv_necessary){if(this.forReject||this.reason)return this.checkReason();this.$message({message:"请填写修改理由!",type:"warning"})}else this.$message({message:"请选择等级!",type:"warning"});else this.$message({message:"请填写优点和待提升部分",type:"warning"})},checkReason:function(){var e=this;return!this.scores.some(function(t){var s=t.score!=t.superior_score&&!t.superior_case;return s&&e.$message.error("".concat(t.question_name,"评分理由未填写，请填写后提交!")),s})},composePostData:function(){var e={};return this.scores.forEach(function(t){e[t.question_id]={score:t.superior_score,cases:[t.superior_case]}}),e.promotion=this.promotion,e.advantage=this.advantage,e._271_level=c["Hc"][this.level],e}},created:function(){this.getMemberDetail(),this.forReject=1==this.$route.query.complain}},l=i,u=(s("dc3a"),s("2877")),d=Object(u["a"])(l,a,r,!1,null,"47bf710a",null);d.options.__file="index.vue";t["default"]=d.exports},"7f7f":function(e,t,s){var a=s("86cc").f,r=Function.prototype,n=/^\s*function ([^ (]*)/,c="name";c in r||s("9e1e")&&a(r,c,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(e){return""}}})},dc3a:function(e,t,s){"use strict";var a=s("048a"),r=s.n(a);r.a}}]);